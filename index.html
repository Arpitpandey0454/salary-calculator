<!doctype html>
<html lang="en" class="scroll-smooth">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>My CTC Calculator</title>

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: { inter: ['Inter', 'sans-serif'] },
                    colors: {
                        primary: '#3b82f6',
                        accent: '#8b5cf6',
                        gray: { 800: '#1f2937', 900: '#111827', 950: '#030712' }
                    }
                }
            }
        }
        // Dark Mode Initializer
        ; (function () {
            if (localStorage.getItem('theme') === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
        })();
    </script>

    <style>
        body { font-family: 'Inter', sans-serif; }
        html { overflow-y: scroll; }

        /* Background Styles */
        .bg-arpit-gradient {
            background-image:
                radial-gradient(1200px 300px at 50% 0%, rgba(0, 0, 0, 0.12), transparent 30%),
                linear-gradient(135deg, rgba(255, 255, 255, 0.04) 0%, rgba(0, 0, 0, 0.02) 100%),
                linear-gradient(90deg, #e8fbf2 0%, #dff4ef 18%, #eaf3ff 55%, #f2f7fb 100%);
            background-repeat: no-repeat;
            background-size: cover;
        }

        .bg-arpit-gradient::before {
            content: '';
            position: fixed;
            inset: 0;
            z-index: -1;
            background-image:
                radial-gradient(1200px 300px at 50% 0%, rgba(0, 0, 0, 0.12), transparent 30%),
                linear-gradient(135deg, rgba(255, 255, 255, 0.04) 0%, rgba(0, 0, 0, 0.02) 100%),
                linear-gradient(90deg, #e8fbf2 0%, #dff4ef 18%, #eaf3ff 55%, #f2f7fb 100%);
            background-repeat: no-repeat;
            background-size: cover;
            filter: saturate(0.98) contrast(0.98);
            pointer-events: none;
        }

        .dark .bg-arpit-gradient::before {
            background-image: none;
            background-color: #030712;
            filter: none;
        }

        /* Form Elements */
        input[type=number]::-webkit-inner-spin-button,
        input[type=number]::-webkit-outer-spin-button { -webkit-appearance: none; margin: 0; }
        input[type=number] { -moz-appearance: textfield; }

        /* Tabs */
        .tab-btn { @apply py-2 px-3 sm:px-4 rounded-lg text-gray-600 dark:text-gray-400 hover:bg-white/80 dark:hover:bg-gray-700/80 font-medium transition-all text-sm; position: relative; padding-bottom: 6px; letter-spacing: 0.3px; transition: color 280ms ease; }
        .tab-btn.tab-active { @apply font-semibold text-teal-800 dark:text-teal-100 bg-white dark:bg-gray-900 shadow-md; color: #0d9488; }
        .dark .tab-btn.tab-active { color: #14b8a6; }
        .tab-btn::after { content: ''; position: absolute; bottom: 0; left: 0; width: 0; height: 2px; background: linear-gradient(90deg, #0d9488, #0e7490); transition: width 320ms cubic-bezier(0.34, 1.56, 0.64, 1); }
        .tab-btn:hover::after { width: 100%; }
        .tab-btn.tab-active::after { width: 100%; background: linear-gradient(90deg, #0d9488, #14b8a6); }

        /* Modal */
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.5); z-index: 1000; overflow-y: auto; backdrop-filter: blur(5px); }
        .modal-content { position: relative; margin: 10% auto; padding: 24px; width: 90%; max-width: 600px; border-radius: 16px; background: white; box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1); color: #374151; }
        .dark .modal-content { background: #1f2937; border: 1px solid #4b5563; color: #e5e7eb; }
        .close-modal { position: absolute; right: 15px; top: 10px; font-size: 24px; cursor: pointer; font-weight: bold; color: #9ca3af; }
        .close-modal:hover { color: #374151; }
        .dark .close-modal:hover { color: #fff; }

        /* Header */
        header {
            position: fixed; left: 50%; transform: translateX(-50%); width: 100%; max-width: 100%;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.9) 0%, rgba(232, 251, 242, 0.8) 50%, rgba(234, 243, 255, 0.75) 100%);
            backdrop-filter: blur(16px) saturate(120%); -webkit-backdrop-filter: blur(16px) saturate(120%);
            border: 1px solid rgba(255, 255, 255, 0.6); border-bottom: 1px solid rgba(0, 0, 0, 0.04);
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.08), 0 8px 24px rgba(13, 148, 136, 0.08), 0 16px 48px rgba(59, 130, 246, 0.04), inset 0 1px 0 rgba(255, 255, 255, 0.8);
            transition: all 280ms cubic-bezier(0.4, 0, 0.2, 1); will-change: box-shadow, background; z-index: 50; overflow: hidden;
        }

     .app-title-gradient {
    font-size: 2.25rem; /* Adjusted for visual balance with h-[80px] logo */
    font-weight: 800; /* Extra bold */
    text-transform: uppercase;
    
    /* The gradient effect */
    background-image: linear-gradient(to right, #00C897 0%, #00C897 35%, #4D4DFF 65%, #4D4DFF 100%);
    -webkit-background-clip: text;
    background-clip: text;
    color: transparent;
    line-height: 1; /* Helps vertically align the text */
}

        @media (min-width: 1024px) { header { width: 70%; max-width: 100%; } }
        header::before { content: ''; position: absolute; top: -40%; right: -10%; width: 300px; height: 300px; background: radial-gradient(circle at 40% 50%, rgba(13, 148, 136, 0.08), transparent 70%); border-radius: 50%; pointer-events: none; animation: blob-float 8s ease-in-out infinite; z-index: 0; }
        header::after { content: ''; position: absolute; bottom: -20%; left: -5%; width: 200px; height: 200px; background: radial-gradient(circle at 60% 40%, rgba(59, 130, 246, 0.06), transparent 70%); border-radius: 50%; pointer-events: none; animation: blob-float 10s ease-in-out infinite reverse; z-index: 0; }
        @keyframes blob-float { 0%, 100% { transform: translateY(0px) scale(1); } 50% { transform: translateY(15px) scale(1.05); } }
        header:hover { box-shadow: 0 2px 4px rgba(0, 0, 0, 0.12), 0 12px 32px rgba(13, 148, 136, 0.12), 0 24px 64px rgba(59, 130, 246, 0.06), inset 0 1px 0 rgba(255, 255, 255, 0.9); }
        header.scrolled {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95) 0%, rgba(232, 251, 242, 0.85) 50%, rgba(234, 243, 255, 0.8) 100%);
            backdrop-filter: blur(20px) saturate(130%); -webkit-backdrop-filter: blur(20px) saturate(130%);
            border-bottom: 1px solid rgba(13, 148, 136, 0.1);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1), 0 16px 40px rgba(13, 148, 136, 0.12), 0 32px 80px rgba(59, 130, 246, 0.06), inset 0 1px 0 rgba(255, 255, 255, 0.9);
           padding: 8px 0; width: 100% !important; max-width: 100% !important; top: 0 !important; border-radius: 0 !important;
        }
        header.scrolled .max-w-5xl { max-width: 95% !important; padding-left: 1.5rem; padding-right: 1.5rem; }
        .dark header {
            background: linear-gradient(135deg, rgba(30, 41, 59, 0.9) 0%, rgba(20, 35, 50, 0.85) 50%, rgba(25, 38, 55, 0.82) 100%);
            border: 1px solid rgba(255, 255, 255, 0.08); border-bottom: 1px solid rgba(255, 255, 255, 0.04);
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3), 0 8px 24px rgba(13, 148, 136, 0.1), 0 16px 48px rgba(59, 130, 246, 0.05), inset 0 1px 0 rgba(255, 255, 255, 0.08);
        }
        .dark header:hover { box-shadow: 0 2px 4px rgba(0, 0, 0, 0.4), 0 12px 32px rgba(13, 148, 136, 0.15), 0 24px 64px rgba(59, 130, 246, 0.08), inset 0 1px 0 rgba(255, 255, 255, 0.12); }
        .dark header.scrolled {
            background: linear-gradient(135deg, rgba(30, 41, 59, 0.95) 0%, rgba(20, 35, 50, 0.9) 50%, rgba(25, 38, 55, 0.88) 100%);
            border-bottom: 1px solid rgba(13, 148, 136, 0.15);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4), 0 16px 40px rgba(13, 148, 136, 0.15), 0 32px 80px rgba(59, 130, 246, 0.08), inset 0 1px 0 rgba(255, 255, 255, 0.1);
            padding: 12px 0;
        }
        header>div, header nav { position: relative; z-index: 10; }

        /* Footer & Logo */
        .footer-logo-box {
            background: rgba(255, 255, 255, 0.6); backdrop-filter: blur(14px) saturate(120%);
            border: 1px solid rgba(255, 255, 255, 0.8); padding: 10px 14px; border-radius: 16px;
            box-shadow: 0 4px 14px rgba(0, 0, 0, 0.08), 0 12px 38px rgba(13, 148, 136, 0.10), 0 20px 60px rgba(59, 130, 246, 0.10);
            transition: all .35s ease;
        }
        .footer-logo-img { width: 70px; height: auto; filter: drop-shadow(0 4px 6px rgba(0, 0, 0, 0.18)); transition: all .35s ease; }
        .footer-logo-box:hover { transform: translateY(-4px) scale(1.05); box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1), 0 16px 40px rgba(13, 148, 136, 0.15), 0 30px 70px rgba(59, 130, 246, 0.12); }
        .footer-logo-box:hover .footer-logo-img { transform: scale(1.09); }

        footer {
            position: relative; overflow: hidden; margin-top: 0; transition: all 300ms ease;
            background: linear-gradient(135deg, #e8fbf2 0%, #dff4ef 25%, #eaf3ff 60%, #f2f7fb 100%);
            box-shadow: inset 0 1px 2px rgba(255, 255, 255, 0.4), 0 -8px 20px rgba(0, 0, 0, 0.04);
        }
        footer::before { content: ''; position: absolute; top: -50%; left: -10%; width: 500px; height: 500px; background: radial-gradient(circle at 30% 40%, rgba(13, 148, 136, 0.08), transparent 70%); border-radius: 50%; pointer-events: none; animation: float 8s ease-in-out infinite; }
        footer::after { content: ''; position: absolute; bottom: -30%; right: -10%; width: 400px; height: 400px; background: radial-gradient(circle at 60% 50%, rgba(59, 130, 246, 0.06), transparent 70%); border-radius: 50%; pointer-events: none; animation: float 10s ease-in-out infinite reverse; }
        @keyframes float { 0%, 100% { transform: translateY(0px); } 50% { transform: translateY(30px); } }
        .dark footer {
            background: linear-gradient(135deg, rgba(17, 24, 39, 0.8) 0%, rgba(15, 23, 42, 0.85) 50%, rgba(30, 41, 59, 0.82) 100%);
            border-top: 1px solid rgba(255, 255, 255, 0.08);
            box-shadow: inset 0 1px 2px rgba(255, 255, 255, 0.05), 0 -8px 20px rgba(0, 0, 0, 0.2);
        }
        footer .max-w-5xl, footer>div { position: relative; z-index: 10; }
        footer h4 { background: linear-gradient(135deg, #0d9488 0%, #0e7490 100%); background-clip: text; -webkit-background-clip: text; -webkit-text-fill-color: transparent; font-weight: 700; letter-spacing: 0.5px; }
        .dark footer h4 { background: linear-gradient(135deg, #14b8a6 0%, #22d3ee 100%); background-clip: text; -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        footer a, footer .footer-tab-btn { position: relative; transition: all 300ms ease; color: #4b5563; }
        .dark footer a, .dark footer .footer-tab-btn { color: #9ca3af; }
        footer a::after, footer .footer-tab-btn::after { content: ''; position: absolute; bottom: -2px; left: 0; width: 0; height: 2px; background: linear-gradient(90deg, #0d9488, #0e7490); transition: width 300ms ease; }
        footer a:hover::after, footer .footer-tab-btn:hover::after { width: 100%; }
        footer a:hover, footer .footer-tab-btn:hover { color: #0d9488; transform: translateX(2px); }
        .dark footer a:hover, .dark footer .footer-tab-btn:hover { color: #14b8a6; }
        footer .mt-12 { background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent); border: none !important; height: 1px; position: relative; z-index: 10; }
        .dark footer .mt-12 { background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent); }
        footer .text-center p { color: #6b7280; font-size: 0.875rem; letter-spacing: 0.3px; font-weight: 500; }
        .dark footer .text-center p { color: #9ca3af; }
    </style>
</head>

<body class="min-h-screen bg-arpit-gradient text-gray-800 dark:text-gray-200 transition-colors duration-300">

   <header class="fixed w-full top-0 z-50 border-b border-gray-200/80 dark:border-white/10 lg:rounded-bl-[30px] lg:rounded-br-[30px] transition-all" style="left: 50%; transform: translateX(-50%);">
    <div class="max-w-5xl mx-auto flex justify-between items-center px-4 sm:px-6 py-3">
        
        
            
            <span class="app-title-gradient tracking-wider font-extrabold text-x1 sm:text-x2 leading-none">
                CTC CALCULATOR
            </span>
        

        <div class="flex items-center space-x-2">
            <div class="hidden sm:flex items-center space-x-2 text-sm">
                <a href="#about-section" class="tab-btn py-1 px-3">About</a>
                <a href="#faq-section" class="tab-btn py-1 px-3">FAQs</a>
                <a href="#" class="tab-btn py-1 px-3">Blog</a>
            </div>
            <button id="theme-toggle" class="p-2 rounded-lg hover:bg-gray-200 dark:hover:bg-white/10 transition-colors">
                <svg id="theme-icon-light" class="w-6 h-6 hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path>
                </svg>
                <svg id="theme-icon-dark" class="w-6 h-6 hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path>
                </svg>
            </button>
            <button id="mobile-menu-toggle" class="sm:hidden p-2 rounded-lg hover:bg-gray-200 dark:hover:bg-white/10 transition-colors">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path>
                </svg>
            </button>
        </div>
        
    </div>

        <nav id="mobile-menu" class="hidden sm:block w-full border-t border-gray-200/80 dark:border-white/10 sm:border-t-0 bg-white dark:bg-gray-900 sm:bg-transparent dark:sm:bg-transparent">
            <div class="flex flex-col sm:flex-row items-start sm:items-center sm:justify-center w-full sm:space-x-8 text-gray-500 text-sm sm:text-base font-extrabold p-4 sm:p-0 sm:max-w-5xl mx-auto space-y-2 sm:space-y-0">
                <button class="tab-btn tab-active" data-tab="ctc-to-inhand">CTC To In-hand</button>
                <button class="tab-btn" data-tab="inhand-to-ctc">In-hand To CTC</button>
                <button class="tab-btn" data-tab="compare">Compare Offers</button>
                <button class="tab-btn" data-tab="tax">Tax Calculator</button>
                <button class="tab-btn" data-tab="hike">Hike Calculator</button>
                <button class="tab-btn" data-tab="additional">Additional Calculator</button>
            </div>
        </nav>
    </header>

    <main class="container mx-auto px-4 py-8 relative z-10 pt-40 sm:pt-48">
        <div id="tab-content">

            <div id="ctc-to-inhand" class="tab-panel">
                <div class="max-w-5xl mx-auto mb-6">
                    <div class="bg-white/60 dark:bg-gray-900 backdrop-blur-lg rounded-3xl shadow-xl border border-gray-200/50 dark:border-gray-800 p-6 sm:p-8">
                        <h2 class="text-3xl font-bold mb-2 text-gray-900 dark:text-gray-100">CTC To In-hand Calculator</h2>
                        <p class="text-gray-600 dark:text-gray-400">Enter your CTC and components to see gross, deductions and net in-hand salary.</p>
                    </div>
                </div>

                <div class="max-w-5xl mx-auto">
                    <div class="bg-white/60 dark:bg-gray-900 backdrop-blur-lg rounded-3xl shadow-xl border border-gray-200/50 dark:border-gray-800 p-6 sm:p-8">
                       
                        <div class="grid grid-cols-1 lg:grid-cols-3 gap-4">
                            <div class="p-6 rounded-2xl bg-amber-40 dark:bg-amber-950/10 border border-amber-200 dark:border-amber-100">
                        <div>
                            <label class="block text-gray-700 dark:text-gray-300 font-medium mb-4">Enter your Annual CTC</label>
                            <div class="flex flex-col">
                                <div class="flex flex-col sm:flex-row items-start sm:items-center space-y-3 sm:space-y-0 sm:space-x-4">
                                    <div class="w-full sm:flex-1">
                                        <div class="flex items-center bg-gray-200 dark:bg-gray-700 rounded-full w-full sm:w-auto sm:min-w-[130px] px-4 py-2">
                                            <span class="text-gray-600 dark:text-gray-300 font-medium">₹</span>
                                            <input type="number" id="ctcInputBox" class="w-full bg-transparent text-gray-700 dark:text-gray-200 font-medium text-right focus:outline-none"
                                                value="1000000" step="1" min="1" max="10000000"
                                                onkeypress="return event.charCode >= 48 && event.charCode <= 57">
                                        </div>
                                        <p id="ctcInWords" class="mt-2 text-sm text-gray-600 dark:text-gray-400">One million rupees</p>
                                    </div>
                                </div>
                                <div id="ctcErrorMsg" class="hidden mt-2 p-3 bg-red-100 border border-red-400 text-red-700 rounded-lg text-sm font-semibold">
                                    Invalid input, provide number more than zero.
                                </div>
                            </div>
                        </div>

                        <hr class="border-gray-200/80 dark:border-gray-700/80">

                        <div class="space-y-4">
                            <h3 class="text-lg font-medium text-gray-800 dark:text-gray-100">Tax Regime</h3>
                            <div class="flex items-center space-x-4">
                                <span class="text-sm font-medium text-gray-600 dark:text-gray-400">Regime:</span>
                                <div class="flex items-center space-x-3">
                                    <label class="inline-flex items-center cursor-pointer">
                                        <input type="radio" name="taxRegime" value="new" checked class="h-4 w-4 text-teal-600 dark:text-teal-500 border-gray-300 dark:border-gray-600 dark:bg-gray-700 focus:ring-teal-500">
                                        <span class="ml-2 text-gray-700 dark:text-gray-300">New</span>
                                    </label>
                                    <label class="inline-flex items-center cursor-pointer">
                                        <input type="radio" name="taxRegime" value="old" class="h-4 w-4 text-teal-600 dark:text-teal-500 border-gray-300 dark:border-gray-600 dark:bg-gray-700 focus:ring-teal-500">
                                        <span class="ml-2 text-gray-700 dark:text-gray-300">Old</span>
                                    </label>
                                </div>
                            </div>
                        </div>

                        <hr class="border-gray-200/80 dark:border-gray-700/80">

                        <div class="space-y-4">
                            <div class="flex justify-between items-center mb-2">
                                <h3 class="text-lg font-medium text-gray-800 dark:text-gray-100">Salary Components</h3>
                                <div class="flex items-center space-x-2 bg-gray-100 dark:bg-gray-700 p-1 rounded-lg">
                                    <label class="inline-flex items-center cursor-pointer">
                                        <input type="radio" name="inputMode" value="percentage" checked class="h-4 w-4 text-teal-600 dark:text-teal-500 border-gray-300 dark:border-gray-600 dark:bg-gray-800 focus:ring-teal-500">
                                        <span class="ml-1 text-sm text-gray-700 dark:text-gray-300">%</span>
                                    </label>
                                    <label class="inline-flex items-center cursor-pointer">
                                        <input type="radio" name="inputMode" value="amount" class="h-4 w-4 text-teal-600 dark:text-teal-500 border-gray-300 dark:border-gray-600 dark:bg-gray-800 focus:ring-teal-500">
                                        <span class="ml-1 text-sm text-gray-700 dark:text-gray-300">₹</span>
                                    </label>
                                </div>
                            </div>

                            <div class="space-y-3">
                                <div class="flex justify-between items-center space-x-4">
                                    <label for="basicInput" class="text-sm text-gray-600 dark:text-gray-400">Basic <span class="component-label font-bold ml-1">(%)</span></label>
                                    <input type="number" id="basicInput" value="40" min="1" max="100" class="w-28 bg-gray-100 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg py-2 px-3 text-gray-800 dark:text-gray-200 text-right focus:ring-2 focus:ring-teal-400 focus:border-transparent transition-all">
                                </div>
                                
                                <div class="flex justify-between items-center space-x-4">
                                    <label for="hraInput" class="text-sm text-gray-600 dark:text-gray-400">HRA (40% of Basic)</label>
                                    <input type="text" id="hraInputDisplay" value="₹0" readonly class="w-28 bg-gray-100 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg py-2 px-3 text-gray-800 dark:text-gray-200 text-right opacity-70 cursor-not-allowed">
                                </div>
                                
                                <div class="flex justify-between items-center space-x-4">
                                    <label for="employerPFInput" class="text-sm text-gray-600 dark:text-gray-400">Employer PF (12% of Basic)</label>
                                    <input type="text" id="employerPFInputDisplay" value="₹0" readonly class="w-28 bg-gray-100 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg py-2 px-3 text-gray-800 dark:text-gray-200 text-right opacity-70 cursor-not-allowed">
                                </div>

                                <div class="flex justify-between items-center space-x-4">
                                    <label for="employeePFInput" class="text-sm text-gray-600 dark:text-gray-400">Employee PF (12% of Basic)</label>
                                    <input type="text" id="employeePFInputDisplay" value="₹0" readonly class="w-28 bg-gray-100 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg py-2 px-3 text-gray-800 dark:text-gray-200 text-right opacity-70 cursor-not-allowed">
                                </div>

                                <div class="flex justify-between items-center space-x-4">
                                    <label for="gratuityInput" class="text-sm text-gray-600 dark:text-gray-400">Gratuity (4.81% of Basic)</label>
                                    <input type="text" id="gratuityInputDisplay" value="₹0" readonly class="w-28 bg-gray-100 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg py-2 px-3 text-gray-800 dark:text-gray-200 text-right opacity-70 cursor-not-allowed">
                                </div>
                                
                                <div class="flex justify-between items-center space-x-4">
                                    <label for="insuranceAmount" class="text-sm text-gray-600 dark:text-gray-400">Insurance (Fixed)</label>
                                    <input type="number" id="insuranceAmount" value="0" min="0" class="w-28 bg-gray-100 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg py-2 px-3 text-gray-800 dark:text-gray-200 text-right focus:ring-2 focus:ring-teal-400 focus:border-transparent transition-all">
                                </div>

                                <div class="flex justify-between items-center space-x-4">
                                    <label for="otherDeductionsAmount" class="text-sm text-gray-600 dark:text-gray-400">Other Deductions (Fixed)</label>
                                    <input type="number" id="otherDeductionsAmount" value="0" min="0" class="w-28 bg-gray-100 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg py-2 px-3 text-gray-800 dark:text-gray-200 text-right focus:ring-2 focus:ring-teal-400 focus:border-transparent transition-all">
                                </div>

                                <div class="flex justify-between items-center space-x-4">
                                    <label for="npsPercent" class="text-sm text-gray-600 dark:text-gray-400">NPS (Max 14% of Basic) <span class="component-label-nps font-bold ml-1">(%)</span></label>
                                    <input type="number" id="npsPercent" value="0" min="0" max="14" class="w-28 bg-gray-100 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg py-2 px-3 text-gray-800 dark:text-gray-200 text-right focus:ring-2 focus:ring-teal-400 focus:border-transparent transition-all">
                                </div>
                                
                                <div class="flex justify-between items-center space-x-4">
                                    <label for="specialInput" class="text-sm text-gray-600 dark:text-gray-400">Special Allowance (Balancing)</label>
                                    <input type="text" id="specialInputDisplay" value="₹0" readonly class="w-28 bg-gray-100 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg py-2 px-3 text-gray-800 dark:text-gray-200 text-right opacity-70 cursor-not-allowed">
                                </div>
                                
                                <label class="flex items-center cursor-pointer pt-3">
                                    <input type="checkbox" id="includeProfTax" checked class="h-5 w-5 text-teal-600 dark:text-teal-500 border-gray-300 dark:border-gray-600 rounded dark:bg-gray-700 focus:ring-teal-500">
                                    <span class="ml-2 text-gray-700 dark:text-gray-300">Professional Tax (₹2,500/Year)</span>
                                </label>
                            </div>
                        </div>

                    </div>

                    <div class="p-6 rounded-2xl bg-sky-50 dark:bg-sky-950/30 border border-sky-200 dark:border-sky-700">
                        <h2 id="regimeTitle" class="text-xl font-semibold text-gray-900 dark:text-gray-100 mb-2">Salary Breakdown under New Tax Regime</h2>
                        <div class="bg-gray-100 dark:bg-gray-800 p-4 rounded-lg text-center">
                            <p class="text-center text-gray-600 dark:text-gray-400 text-sm">Net Monthly Salary</p>
                            <h3 class="text-3xl font-bold text-center text-teal-600 dark:text-teal-400" id="monthlyInHand">₹0</h3>
                            <p class="text-center text-gray-500 dark:text-gray-500 text-sm mt-2">Net Annual: <span id="netYearly" class="font-medium text-gray-600 dark:text-gray-400">₹0</span></p>
                        </div>
                        <canvas id="salaryChart" class="max-h-64 sm:max-h-72"></canvas>
                        
                        <div>
                            <h3 class="font-semibold mb-3 text-gray-800 dark:text-gray-100">Earnings Breakdown (Annual)</h3>
                            <div class="space-y-2 text-sm" id="earningsBreakdown">
                                <div class="flex justify-between"><span class="text-gray-600 dark:text-gray-400">Basic Salary</span> <span id="basicAmount" class="font-medium text-gray-900 dark:text-gray-100">₹0</span></div>
                                <div class="flex justify-between"><span class="text-gray-600 dark:text-gray-400">HRA</span> <span id="hraAmount" class="font-medium text-gray-900 dark:text-gray-100">₹0</span></div>
                                <div class="flex justify-between"><span class="text-gray-600 dark:text-gray-400">Special Allowance</span> <span id="specialAmount" class="font-medium text-gray-900 dark:text-gray-100">₹0</span></div>
                                <div class="flex justify-between font-semibold border-t border-gray-300 dark:border-gray-700 pt-2 mt-2 text-gray-900 dark:text-gray-100">
                                    <span>Gross Salary (Taxable Income Source)</span> <span id="grossYearly">₹0</span>
                                </div>
                            </div>
                        </div>
                        
                        <div>
                            <h3 class="font-semibold mb-3 text-gray-800 dark:text-gray-100">Tax Calculation</h3>
                            <div class="space-y-2 text-sm" id="taxBreakdown">
                                <div class="flex justify-between"><span class="text-gray-600 dark:text-gray-400">Gross Salary</span> <span id="grossForTax" class="font-medium text-gray-900 dark:text-gray-100">₹0</span></div>
                                <div class="flex justify-between text-red-600 dark:text-red-400">
                                    <span>Standard Deduction</span> <span id="standardDeduction">-₹0</span>
                                </div>
                                <div class="flex justify-between font-semibold border-t border-gray-300 dark:border-gray-700 pt-2 mt-2 text-gray-900 dark:text-gray-100">
                                    <span>Taxable Income (before other ded.)</span> <span id="taxableIncomeInitial">₹0</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="p-6 rounded-2xl bg-rose-40 dark:bg-rose-500/8 border border-rose-200 dark:border-rose-100">
                        <div>
                            <h3 class="font-semibold mb-3 text-gray-800 dark:text-gray-100">Deductions (Annual)</h3>
                            <div class="space-y-2 text-sm" id="deductionsBreakdown">
                                <div class="flex justify-between"><span class="text-gray-600 dark:text-gray-400">Employee EPF (12% of Basic)</span> <span id="epfEmployee" class="text-red-600 dark:text-red-400 font-medium">₹0</span></div>
                                <div class="flex justify-between"><span class="text-gray-600 dark:text-gray-400">Employee NPS (max 14% of Basic)</span> <span id="npsDeduction" class="text-red-600 dark:text-red-400 font-medium">₹0</span></div>
                                <div class="flex justify-between"><span class="text-gray-600 dark:text-gray-400">Professional Tax</span> <span id="profTaxAmount" class="text-red-600 dark:text-red-400 font-medium">₹0</span></div>
                                <div class="flex justify-between items-center">
                                    <span class="text-gray-600 dark:text-gray-400">Income Tax (TDS)</span>
                                    <div class="flex items-center">
                                        <span id="incomeTax" class="text-red-600 dark:text-red-400 font-medium mr-2">₹0</span>
                                        <button id="showTaxDetails" class="text-teal-600 dark:text-teal-400 hover:text-teal-700 dark:hover:text-teal-300 text-xs font-medium">(Details)</button>
                                    </div>
                                </div>
                                <div class="flex justify-between font-semibold border-t border-gray-300 dark:border-gray-700 pt-2 mt-2 text-red-700 dark:text-red-400">
                                    <span>Total Employee Deductions</span> <span id="deductionsYearly">₹0</span>
                                </div>
                            </div>
                        </div>

                        <hr class="border-gray-200/80 dark:border-gray-700/80">

                        <div>
                            <h3 class="font-semibold mb-3 text-gray-800 dark:text-gray-100">Cost to Company Breakup (Total CTC)</h3>
                            <div class="space-y-2 text-sm bg-gray-100 dark:bg-gray-800 p-3 rounded-lg">
                                <div class="flex justify-between"><span class="text-gray-600 dark:text-gray-400">Basic + HRA + Special Allowance (Gross Salary)</span> <span id="grossSalaryCtc" class="font-medium text-gray-900 dark:text-gray-100">₹0</span></div>
                                <div class="flex justify-between"><span class="text-gray-600 dark:text-gray-400">Employer EPF (12% of Basic)</span> <span id="employerEpfCtc" class="font-medium text-gray-900 dark:text-gray-100">₹0</span></div>
                                <div class="flex justify-between"><span class="text-gray-600 dark:text-gray-400">Gratuity (4.81% of Basic)</span> <span id="gratuityEmployerCtc" class="font-medium text-gray-900 dark:text-gray-100">₹0</span></div>
                                <div class="flex justify-between"><span class="text-gray-600 dark:text-gray-400">Insurance (Employer Fixed)</span> <span id="insuranceEmployerCtc" class="font-medium text-gray-900 dark:text-gray-100">₹0</span></div>
                                <div class="flex justify-between"><span class="text-gray-600 dark:text-gray-400">Other Deductions (Employer Fixed)</span> <span id="otherEmployerDeductionCtc" class="font-medium text-gray-900 dark:text-gray-100">₹0</span></div>
                                <div class="flex justify-between font-bold border-t border-gray-300 dark:border-gray-700 pt-2 mt-2 text-gray-900 dark:text-gray-100">
                                    <span>Total CTC</span> <span id="totalCtc">₹0</span>
                                </div>
                            </div>
                        </div>

                        <hr class="border-gray-200/80 dark:border-gray-700/80">

                        <div>
                            <h3 class="font-semibold mb-3 text-gray-800 dark:text-gray-100">Download Report</h3>
                            <div class="grid grid-cols-2 gap-4">
                                <button id="downloadPdf" class="flex items-center justify-center bg-teal-600 text-white px-4 py-3 rounded-lg hover:bg-teal-700 dark:bg-teal-600 dark:hover:bg-teal-700 font-semibold transition-all">
                                    <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" /></svg>
                                    PDF
                                </button>
                                <button id="downloadExcel" class="flex items-center justify-center bg-blue-600 text-white px-4 py-3 rounded-lg hover:bg-blue-700 dark:bg-blue-600 dark:hover:bg-blue-700 font-semibold transition-all">
                                    <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" /></svg>
                                    Excel
                                </button>
                            </div>
                        </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="inhand-to-ctc" class="tab-panel hidden">
                <div class="max-w-5xl mx-auto mb-6">
                    <div class="bg-white/60 dark:bg-gray-900 backdrop-blur-lg rounded-3xl shadow-xl border border-gray-200/50 dark:border-gray-800 p-6 sm:p-8">
                        <h2 class="text-3xl font-bold mb-2 text-gray-900 dark:text-gray-100">In-hand TO CTC Calculator</h2>
                        <p class="text-gray-600 dark:text-gray-400">Enter desired monthly in-hand to estimate required CTC and breakdown.</p>
                    </div>
                </div>

                <div class="max-w-5xl mx-auto">
                    <div class="bg-white/60 dark:bg-gray-900 backdrop-blur-lg rounded-3xl shadow-xl border border-gray-200/50 dark:border-gray-800 p-6 sm:p-8">
                        
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mt-3">
                            <div class="p-6 rounded-2xl bg-amber-48 dark:bg-amber-950/10 border border-amber-200 dark:border-amber-100">
                                <!-- Left: Input Panel -->
                                <h4 class="font-semibold mb-3 text-gray-800 dark:text-gray-100">Calculate CTC from In-hand</h4>
                                <div>
                                    <label class="block text-gray-700 dark:text-gray-300 font-medium mb-4">Desired Net Monthly In-hand</label>
                                    <div class="flex flex-col sm:flex-row items-start sm:items-center space-y-3 sm:space-y-0 sm:space-x-4">
                                        <div class="w-full sm:flex-1">
                                            <div class="flex items-center bg-gray-200 dark:bg-gray-700 rounded-full w-full sm:w-auto sm:min-w-[130px] px-4 py-2">
                                                <span class="text-gray-600 dark:text-gray-300 font-medium">₹</span>
                                                <input type="number" id="monthlyInHandInputBox" class="w-full bg-transparent text-gray-700 dark:text-gray-200 font-medium text-right focus:outline-none" value="70000" step="1000" min="10000" max="500000">
                                            </div>
                                            <p id="monthlyInWords" class="mt-2 text-sm text-gray-600 dark:text-gray-400">Seventy thousand rupees</p>
                                        </div>
                                    </div>
                                </div>

                                <div class="mt-4">
                                    <h5 class="text-sm font-medium text-gray-700 dark:text-gray-300">Tax Regime</h5>
                                    <div class="flex items-center space-x-4 mt-2">
                                        <label class="inline-flex items-center cursor-pointer">
                                            <input type="radio" name="taxRegime_reverse" value="new" checked class="h-4 w-4 text-teal-600 dark:text-teal-500 border-gray-300 dark:border-gray-600 dark:bg-gray-700 focus:ring-teal-500">
                                            <span class="ml-2 text-gray-700 dark:text-gray-300">New</span>
                                        </label>
                                        <label class="inline-flex items-center cursor-pointer">
                                            <input type="radio" name="taxRegime_reverse" value="old" class="h-4 w-4 text-teal-600 dark:text-teal-500 border-gray-300 dark:border-gray-600 dark:bg-gray-700 focus:ring-teal-500">
                                            <span class="ml-2 text-gray-700 dark:text-gray-300">Old</span>
                                        </label>
                                    </div>
                                </div>

                                <hr class="border-gray-200/80 dark:border-gray-700/80 my-4">

                                <div class="space-y-3">
                                    <h5 class="text-sm font-medium text-gray-700 dark:text-gray-300">Assumed Deductions</h5>
                                    <label class="flex items-center cursor-pointer mt-2">
                                        <input type="checkbox" id="includePF_reverse" checked class="h-5 w-5 text-teal-600 dark:text-teal-500 border-gray-300 dark:border-gray-600 rounded dark:bg-gray-700 focus:ring-teal-500">
                                        <span class="ml-2 text-gray-700 dark:text-gray-300">EPF Applicable</span>
                                    </label>
                                    <label class="flex items-center cursor-pointer">
                                        <input type="checkbox" id="includeProfTax_reverse" checked class="h-5 w-5 text-teal-600 dark:text-teal-500 border-gray-300 dark:border-gray-600 rounded dark:bg-gray-700 focus:ring-teal-500">
                                        <span class="ml-2 text-gray-700 dark:text-gray-300">Professional Tax</span>
                                    </label>
                                </div>

                                <button id="calculateReverse" class="mt-4 w-full bg-teal-600 hover:bg-teal-700 text-white font-semibold py-3 rounded-full transition-colors duration-200 shadow-lg">
                                    Calculate Required CTC
                                </button>
                            </div>

                            <div id="reverseResultCard" class="p-6 rounded-2xl bg-sky-50 dark:bg-sky-950/30 border border-sky-200 dark:border-sky-700">
                                <!-- Middle: Results Panel -->
                                <h4 id="reverseRegimeTitle" class="font-semibold mb-3 text-gray-800 dark:text-gray-100">Required CTC Breakdown</h4>
                                <div class="bg-gray-100 dark:bg-gray-800 p-4 rounded-lg text-center mb-4">
                                    <p class="text-center text-gray-600 dark:text-gray-400 text-sm">Required Annual CTC</p>
                                    <h3 class="text-3xl font-bold text-center text-blue-600 dark:text-blue-400" id="calculatedCTC">₹0</h3>
                                    <p class="text-center text-gray-500 dark:text-gray-500 text-sm mt-2">Gives Net Monthly: <span id="calculatedMonthlyInHand" class="font-medium text-gray-600 dark:text-gray-400">₹0</span></p>
                                </div>
                                <canvas id="reverseSalaryChart" class="max-h-64 sm:max-h-72 mb-4"></canvas>
                                <div>
                                    <h5 class="font-semibold mb-2 text-gray-800 dark:text-gray-100">Cost to Company Breakup</h5>
                                    <div class="space-y-2 text-sm bg-gray-100 dark:bg-gray-800 p-3 rounded-lg">
                                        <div class="flex justify-between"><span class="text-gray-600 dark:text-gray-400">Gross Salary</span> <span id="reverse_grossSalaryCtc" class="font-medium text-gray-900 dark:text-gray-100">₹0</span></div>
                                        <div class="flex justify-between"><span class="text-gray-600 dark:text-gray-400">Employer EPF</span> <span id="reverse_employerEpfCtc" class="font-medium text-gray-900 dark:text-gray-100">₹0</span></div>
                                        <div class="flex justify-between font-bold border-t border-gray-300 dark:border-gray-700 pt-2 mt-2 text-gray-900 dark:text-gray-100">
                                            <span>Total CTC</span> <span id="reverse_totalCtc">₹0</span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="p-6 rounded-2xl bg-rose-40 dark:bg-rose-950/10 border border-rose-200 dark:border-rose-100">
                                <!-- Right: Breakdown Panel -->
                                <h4 class="font-semibold mb-3 text-gray-800 dark:text-gray-100">Earnings & Deductions</h4>
                                <div class="space-y-2 text-sm mb-4">
                                    <div class="flex justify-between"><span class="text-gray-600 dark:text-gray-400">Basic Salary</span> <span id="reverse_basicAmount" class="font-medium text-gray-900 dark:text-gray-100">₹0</span></div>
                                    <div class="flex justify-between"><span class="text-gray-600 dark:text-gray-400">HRA</span> <span id="reverse_hraAmount" class="font-medium text-gray-900 dark:text-gray-100">₹0</span></div>
                                    <div class="flex justify-between"><span class="text-gray-600 dark:text-gray-400">Special Allowance</span> <span id="reverse_specialAmount" class="font-medium text-gray-900 dark:text-gray-100">₹0</span></div>
                                    <div class="flex justify-between font-semibold border-t border-gray-300 dark:border-gray-700 pt-2 mt-2 text-gray-900 dark:text-gray-100">
                                        <span>Gross Salary</span> <span id="reverse_grossYearly">₹0</span>
                                    </div>
                                </div>

                                <hr class="border-gray-200/80 dark:border-gray-700/80 mb-4">

                                <div>
                                    <h5 class="font-semibold mb-2 text-gray-800 dark:text-gray-100">Deductions (Annual)</h5>
                                    <div class="space-y-2 text-sm">
                                        <div class="flex justify-between"><span class="text-gray-600 dark:text-gray-400">EPF (Employee)</span> <span id="reverse_epfEmployee" class="text-red-600 dark:text-red-400 font-medium">₹0</span></div>
                                        <div class="flex justify-between"><span class="text-gray-600 dark:text-gray-400">Professional Tax</span> <span id="reverse_profTaxAmount" class="text-red-600 dark:text-red-400 font-medium">₹0</span></div>
                                        <div class="flex justify-between"><span class="text-gray-600 dark:text-gray-400">Income Tax</span> <span id="reverse_incomeTax" class="text-red-600 dark:text-red-400 font-medium">₹0</span></div>
                                        <div class="flex justify-between font-semibold border-t border-gray-300 dark:border-gray-700 pt-2 mt-2 text-red-700 dark:text-red-400">
                                            <span>Total Deductions</span> <span id="reverse_deductionsYearly">₹0</span>
                                        </div>
                                    </div>
                                </div>

                                <hr class="border-gray-200/80 dark:border-gray-700/80 mt-4">
                                <div class="mt-4">
                                    <h5 class="font-semibold mb-2 text-gray-800 dark:text-gray-100">Download Report</h5>
                                    <div class="grid grid-cols-2 gap-4">
                                        <button id="downloadPdf_reverse" class="flex items-center justify-center bg-teal-600 text-white px-4 py-3 rounded-lg hover:bg-teal-700 dark:bg-teal-600 dark:hover:bg-teal-700 font-semibold transition-all">
                                            <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" /></svg>
                                            PDF
                                        </button>
                                        <button id="downloadExcel_reverse" class="flex items-center justify-center bg-blue-600 text-white px-4 py-3 rounded-lg hover:bg-blue-700 dark:bg-blue-600 dark:hover:bg-blue-700 font-semibold transition-all">
                                            <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" /></svg>
                                            Excel
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="compare" class="tab-panel hidden">
                <div class="max-w-5xl mx-auto">
                    <div class="bg-white/60 dark:bg-gray-900 backdrop-blur-lg rounded-3xl shadow-xl dark:shadow-none border border-gray-200/50 dark:border-gray-800 p-6 sm:p-8">
                        <h2 class="text-3xl font-bold mb-2 text-gray-900 dark:text-gray-100">Compare CTC Offers</h2>
                        <p class="text-gray-600 dark:text-gray-400 mb-8">Compare two salary offers side by side</p>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                            <!-- Offer 1 -->
                            <div class="border-2 border-teal-200 dark:border-teal-700 rounded-2xl p-6 bg-teal-50 dark:bg-teal-950/30">
                                <h3 class="text-xl font-bold text-teal-900 dark:text-teal-100 mb-4">Offer 1</h3>
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">CTC (₹)</label>
                                        <input type="number" id="offerCtc1" placeholder="50,00,000" min="1" max="10000000" class="w-full bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg py-2 px-3 text-gray-800 dark:text-gray-200 focus:ring-2 focus:ring-teal-400 focus:border-transparent transition-all">
                                        <p id="offerCtc1Words" class="mt-2 text-sm text-gray-600 dark:text-gray-400">Zero rupees</p>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Tax Regime</label>
                                        <select id="offerRegime1" class="w-full bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg py-2 px-3 text-gray-800 dark:text-gray-200">
                                            <option value="new">New Regime</option>
                                            <option value="old">Old Regime</option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                            <!-- Offer 2 -->
                            <div class="border-2 border-blue-200 dark:border-blue-700 rounded-2xl p-6 bg-blue-50 dark:bg-blue-950/30">
                                <h3 class="text-xl font-bold text-blue-900 dark:text-blue-100 mb-4">Offer 2</h3>
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">CTC (₹)</label>
                                        <input type="number" id="offerCtc2" placeholder="55,00,000" min="1" max="10000000" class="w-full bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg py-2 px-3 text-gray-800 dark:text-gray-200 focus:ring-2 focus:ring-blue-400 focus:border-transparent transition-all">
                                        <p id="offerCtc2Words" class="mt-2 text-sm text-gray-600 dark:text-gray-400">Zero rupees</p>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Tax Regime</label>
                                        <select id="offerRegime2" class="w-full bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg py-2 px-3 text-gray-800 dark:text-gray-200">
                                            <option value="new">New Regime</option>
                                            <option value="old">Old Regime</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <button id="compareButton" class="w-full bg-gradient-to-r from-teal-500 to-blue-500 hover:from-teal-600 hover:to-blue-600 text-white font-bold py-3 px-6 rounded-lg transition-all mb-8">Compare Offers</button>

                        <!-- Comparison Results -->
                        <div id="compareResults" class="hidden space-y-6">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div class="bg-teal-50 dark:bg-teal-950/30 p-6 rounded-2xl border border-teal-200 dark:border-teal-700">
                                    <h4 class="font-semibold text-teal-900 dark:text-teal-100 mb-4">Offer 1 Summary</h4>
                                    <div class="space-y-3 text-sm">
                                        <div class="flex justify-between"><span class="text-gray-700 dark:text-gray-300">Gross Salary</span><span id="compare1Gross" class="font-bold text-gray-900 dark:text-gray-100">₹0</span></div>
                                        <div class="flex justify-between"><span class="text-gray-700 dark:text-gray-300">Total Deductions</span><span id="compare1Deductions" class="font-bold text-gray-900 dark:text-gray-100">₹0</span></div>
                                        <div class="flex justify-between border-t border-teal-200 dark:border-teal-700 pt-2"><span class="text-gray-700 dark:text-gray-300 font-bold">In-hand (Yearly)</span><span id="compare1InHand" class="font-bold text-teal-600 dark:text-teal-400">₹0</span></div>
                                        <div class="flex justify-between"><span class="text-gray-700 dark:text-gray-300 font-bold">In-hand (Monthly)</span><span id="compare1Monthly" class="font-bold text-teal-600 dark:text-teal-400">₹0</span></div>
                                    </div>
                                </div>

                                <div class="bg-blue-50 dark:bg-blue-950/30 p-6 rounded-2xl border border-blue-200 dark:border-blue-700">
                                    <h4 class="font-semibold text-blue-900 dark:text-blue-100 mb-4">Offer 2 Summary</h4>
                                    <div class="space-y-3 text-sm">
                                        <div class="flex justify-between"><span class="text-gray-700 dark:text-gray-300">Gross Salary</span><span id="compare2Gross" class="font-bold text-gray-900 dark:text-gray-100">₹0</span></div>
                                        <div class="flex justify-between"><span class="text-gray-700 dark:text-gray-300">Total Deductions</span><span id="compare2Deductions" class="font-bold text-gray-900 dark:text-gray-100">₹0</span></div>
                                        <div class="flex justify-between border-t border-blue-200 dark:border-blue-700 pt-2"><span class="text-gray-700 dark:text-gray-300 font-bold">In-hand (Yearly)</span><span id="compare2InHand" class="font-bold text-blue-600 dark:text-blue-400">₹0</span></div>
                                        <div class="flex justify-between"><span class="text-gray-700 dark:text-gray-300 font-bold">In-hand (Monthly)</span><span id="compare2Monthly" class="font-bold text-blue-600 dark:text-blue-400">₹0</span></div>
                                    </div>
                                </div>
                            </div>

                            <!-- Comparison Difference -->
                            <div class="bg-gradient-to-r from-green-50 to-emerald-50 dark:from-green-950/30 dark:to-emerald-950/30 p-6 rounded-2xl border border-green-200 dark:border-green-700">
                                <h4 class="font-semibold text-green-900 dark:text-green-100 mb-4">Difference Analysis</h4>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
                                    <div>
                                        <span class="text-gray-700 dark:text-gray-300">CTC Difference (Yearly)</span>
                                        <p id="compareCTCDiff" class="text-2xl font-bold text-green-600 dark:text-green-400">₹0</p>
                                    </div>
                                    <div>
                                        <span class="text-gray-700 dark:text-gray-300">In-hand Difference (Yearly)</span>
                                        <p id="compareInHandDiff" class="text-2xl font-bold text-green-600 dark:text-green-400">₹0</p>
                                    </div>
                                    <div>
                                        <span class="text-gray-700 dark:text-gray-300">Monthly In-hand Difference</span>
                                        <p id="compareMonthlyDiff" class="text-2xl font-bold text-green-600 dark:text-green-400">₹0</p>
                                    </div>
                                    <div>
                                        <span class="text-gray-700 dark:text-gray-300">Better Offer</span>
                                        <p id="compareBetterOffer" class="text-xl font-bold text-green-600 dark:text-green-400">—</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="tax" class="tab-panel hidden">
                <div class="max-w-5xl mx-auto">
                    <div class="bg-white/60 dark:bg-gray-900 backdrop-blur-lg rounded-3xl shadow-xl dark:shadow-none border border-gray-200/50 dark:border-gray-800 p-6 sm:p-8">
                        <h2 class="text-3xl font-bold mb-2 text-gray-900 dark:text-gray-100">Tax Calculator (Old vs New Regime)</h2>
                        <p class="text-gray-600 dark:text-gray-400 mb-8">Calculate and compare tax under both regimes</p>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                            <!-- Inputs -->
                            <div class="bg-gradient-to-br from-gray-50 to-gray-100 dark:from-gray-800 dark:to-gray-700 p-6 rounded-2xl border border-gray-200 dark:border-gray-600">
                                <h3 class="font-bold text-lg text-gray-900 dark:text-gray-100 mb-4">Annual Income</h3>
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Gross Salary (₹)</label>
                                        <input type="number" id="taxGrossIncome" placeholder="0" min="0" class="w-full bg-white dark:bg-gray-600 border border-gray-300 dark:border-gray-500 rounded-lg py-2 px-3 text-gray-800 dark:text-gray-200 focus:ring-2 focus:ring-teal-400 transition-all">
                                        <p id="taxGrossWords" class="mt-2 text-sm text-gray-600 dark:text-gray-400">Zero rupees</p>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Employee PF (₹)</label>
                                        <input type="number" id="taxEmpPF" value="0" min="0" class="w-full bg-white dark:bg-gray-600 border border-gray-300 dark:border-gray-500 rounded-lg py-2 px-3 text-gray-800 dark:text-gray-200 focus:ring-2 focus:ring-teal-400 transition-all">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">NPS Contribution (₹)</label>
                                        <input type="number" id="taxNPS" value="0" min="0" class="w-full bg-white dark:bg-gray-600 border border-gray-300 dark:border-gray-500 rounded-lg py-2 px-3 text-gray-800 dark:text-gray-200 focus:ring-2 focus:ring-teal-400 transition-all">
                                    </div>
                                </div>
                            </div>

                            <!-- Tax Slabs Info -->
                            <div class="bg-blue-50 dark:bg-blue-950/30 p-6 rounded-2xl border border-blue-200 dark:border-blue-700">
                                <h3 class="font-bold text-lg text-blue-900 dark:text-blue-100 mb-4">Tax Slabs 2025</h3>
                                <div class="space-y-3 text-sm">
                                    <div>
                                        <p class="font-semibold text-gray-700 dark:text-gray-300 mb-2">New Regime:</p>
                                        <ul class="space-y-1 text-gray-600 dark:text-gray-400 text-xs">
                                            <li>0-3L: 0% | 3-6L: 5% | 6-9L: 10%</li>
                                            <li>9-12L: 15% | 12-15L: 20% | 15L+: 30%</li>
                                        </ul>
                                    </div>
                                    <div>
                                        <p class="font-semibold text-gray-700 dark:text-gray-300 mb-2">Old Regime:</p>
                                        <ul class="space-y-1 text-gray-600 dark:text-gray-400 text-xs">
                                            <li>0-2.5L: 0% | 2.5-5L: 5% | 5-10L: 20%</li>
                                            <li>10L+: 30% (with surcharge & cess)</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <button id="calculateTaxButton" class="w-full bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white font-bold py-3 px-6 rounded-lg transition-all mb-8">Calculate Tax</button>

                        <!-- Tax Results -->
                        <div id="taxResults" class="hidden space-y-6">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <!-- Old Regime -->
                                <div class="border-2 border-amber-200 dark:border-amber-700 rounded-2xl p-6 bg-amber-50 dark:bg-amber-950/30">
                                    <h4 class="font-bold text-lg text-amber-900 dark:text-amber-100 mb-4">Old Regime</h4>
                                    <div class="space-y-2 text-sm">
                                        <div class="flex justify-between"><span class="text-gray-700 dark:text-gray-300">Gross Income</span><span id="taxOldGross" class="font-bold">₹0</span></div>
                                        <div class="flex justify-between"><span class="text-gray-700 dark:text-gray-300">Standard Deduction</span><span id="taxOldStdDed" class="font-bold">₹50,000</span></div>
                                        <div class="flex justify-between"><span class="text-gray-700 dark:text-gray-300">Section 80C (PF)</span><span id="taxOld80C" class="font-bold">₹0</span></div>
                                        <div class="flex justify-between"><span class="text-gray-700 dark:text-gray-300">80CCD(1B) (NPS)</span><span id="taxOld80CCD" class="font-bold">₹0</span></div>
                                        <div class="flex justify-between border-t border-amber-200 dark:border-amber-700 pt-2"><span class="text-gray-700 dark:text-gray-300 font-bold">Taxable Income</span><span id="taxOldTaxable" class="font-bold">₹0</span></div>
                                        <div class="flex justify-between"><span class="text-gray-700 dark:text-gray-300">Income Tax</span><span id="taxOldTax" class="font-bold text-amber-600 dark:text-amber-400">₹0</span></div>
                                        <div class="flex justify-between"><span class="text-gray-700 dark:text-gray-300">Surcharge & Cess</span><span id="taxOldSurcharge" class="font-bold text-amber-600 dark:text-amber-400">₹0</span></div>
                                        <div class="flex justify-between bg-amber-100 dark:bg-amber-900/50 p-2 rounded border-t-2 border-amber-200 dark:border-amber-700 pt-3"><span class="font-bold text-amber-900 dark:text-amber-100">Total Tax</span><span id="taxOldTotal" class="font-bold text-lg text-amber-900 dark:text-amber-100">₹0</span></div>
                                    </div>
                                </div>

                                <!-- New Regime -->
                                <div class="border-2 border-green-200 dark:border-green-700 rounded-2xl p-6 bg-green-50 dark:bg-green-950/30">
                                    <h4 class="font-bold text-lg text-green-900 dark:text-green-100 mb-4">New Regime</h4>
                                    <div class="space-y-2 text-sm">
                                        <div class="flex justify-between"><span class="text-gray-700 dark:text-gray-300">Gross Income</span><span id="taxNewGross" class="font-bold">₹0</span></div>
                                        <div class="flex justify-between"><span class="text-gray-700 dark:text-gray-300">Standard Deduction</span><span id="taxNewStdDed" class="font-bold">₹50,000</span></div>
                                        <div class="flex justify-between"><span class="text-gray-700 dark:text-gray-300">Section 87A Rebate</span><span id="taxNewRebate" class="font-bold">Upto 7L</span></div>
                                        <div class="flex justify-between border-t border-green-200 dark:border-green-700 pt-2"><span class="text-gray-700 dark:text-gray-300 font-bold">Taxable Income</span><span id="taxNewTaxable" class="font-bold">₹0</span></div>
                                        <div class="flex justify-between"><span class="text-gray-700 dark:text-gray-300">Income Tax</span><span id="taxNewTax" class="font-bold text-green-600 dark:text-green-400">₹0</span></div>
                                        <div class="flex justify-between"><span class="text-gray-700 dark:text-gray-300">Surcharge & Cess</span><span id="taxNewSurcharge" class="font-bold text-green-600 dark:text-green-400">₹0</span></div>
                                        <div class="flex justify-between bg-green-100 dark:bg-green-900/50 p-2 rounded border-t-2 border-green-200 dark:border-green-700 pt-3"><span class="font-bold text-green-900 dark:text-green-100">Total Tax</span><span id="taxNewTotal" class="font-bold text-lg text-green-900 dark:text-green-100">₹0</span></div>
                                    </div>
                                </div>
                            </div>

                            <!-- Recommendation -->
                            <div class="bg-gradient-to-r from-indigo-50 to-purple-50 dark:from-indigo-950/30 dark:to-purple-950/30 p-6 rounded-2xl border border-indigo-200 dark:border-indigo-700">
                                <h4 class="font-bold text-lg text-indigo-900 dark:text-indigo-100 mb-3">Recommendation</h4>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                        <p class="text-sm text-gray-700 dark:text-gray-300 mb-1">Tax Saving</p>
                                        <p id="taxSaving" class="text-2xl font-bold text-indigo-600 dark:text-indigo-400">₹0</p>
                                    </div>
                                    <div>
                                        <p class="text-sm text-gray-700 dark:text-gray-300 mb-1">Better Regime</p>
                                        <p id="taxBetterRegime" class="text-2xl font-bold text-indigo-600 dark:text-indigo-400">—</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="hike" class="tab-panel hidden">
                <div class="max-w-5xl mx-auto">
                    <div class="bg-white/60 dark:bg-gray-900 backdrop-blur-lg rounded-3xl shadow-xl dark:shadow-none border border-gray-200/50 dark:border-gray-800 p-6 sm:p-8">
                        <h2 class="text-3xl font-bold mb-2 text-gray-900 dark:text-gray-100">Hike Calculator</h2>
                        <p class="text-gray-600 dark:text-gray-400 mb-8">Calculate revised salary after a percentage hike</p>
                        
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
                            <!-- Input Section -->
                            <div class="bg-gradient-to-br from-blue-50 to-cyan-50 dark:from-blue-950/30 dark:to-cyan-950/30 p-6 rounded-2xl border border-blue-200 dark:border-blue-700">
                                <h3 class="font-bold text-lg text-blue-900 dark:text-blue-100 mb-6">Current Salary</h3>
                                <div class="space-y-4 mb-6">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Current CTC (₹)</label>
                                        <input type="number" id="hikeCurrentCtc" placeholder="50,00,000" min="1" max="10000000" class="w-full bg-white dark:bg-gray-600 border border-gray-300 dark:border-gray-500 rounded-lg py-2 px-3 text-gray-800 dark:text-gray-200 focus:ring-2 focus:ring-blue-400 transition-all">
                                        <p id="hikeCurrentCtcWords" class="mt-2 text-sm text-gray-600 dark:text-gray-400">Zero rupees</p>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Current Monthly In-hand (₹)</label>
                                        <input type="number" id="hikeCurrentMonthly" placeholder="3,00,000" min="0" class="w-full bg-white dark:bg-gray-600 border border-gray-300 dark:border-gray-500 rounded-lg py-2 px-3 text-gray-800 dark:text-gray-200 focus:ring-2 focus:ring-blue-400 transition-all">
                                        <p id="hikeCurrentMonthlyWords" class="mt-2 text-sm text-gray-600 dark:text-gray-400">Zero rupees</p>
                                    </div>
                                </div>

                                <h3 class="font-bold text-lg text-blue-900 dark:text-blue-100 mb-6 pt-4 border-t border-blue-200 dark:border-blue-700">Hike Details</h3>
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Hike Percentage (%)</label>
                                        <input type="number" id="hikePercentage" value="10" min="0" max="100" step="0.5" class="w-full bg-white dark:bg-gray-600 border border-gray-300 dark:border-gray-500 rounded-lg py-2 px-3 text-gray-800 dark:text-gray-200 focus:ring-2 focus:ring-blue-400 transition-all">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Tax Regime</label>
                                        <select id="hikeRegime" class="w-full bg-white dark:bg-gray-600 border border-gray-300 dark:border-gray-500 rounded-lg py-2 px-3 text-gray-800 dark:text-gray-200">
                                            <option value="new">New Regime</option>
                                            <option value="old">Old Regime</option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                            <!-- Revised Salary Section -->
                            <div class="bg-gradient-to-br from-green-50 to-emerald-50 dark:from-green-950/30 dark:to-emerald-950/30 p-6 rounded-2xl border border-green-200 dark:border-green-700">
                                <h3 class="font-bold text-lg text-green-900 dark:text-green-100 mb-6">Revised Salary</h3>
                                <div class="space-y-4" id="hikeRevisedSalary">
                                    <div>
                                        <p class="text-sm text-gray-700 dark:text-gray-300 mb-1">New CTC</p>
                                        <p id="hikeNewCtc" class="text-2xl font-bold text-green-600 dark:text-green-400">₹0</p>
                                        <p id="hikeCtcIncrease" class="text-xs text-gray-600 dark:text-gray-400 mt-1">Increase: ₹0</p>
                                    </div>
                                    <div class="border-t border-green-200 dark:border-green-700 pt-4">
                                        <p class="text-sm text-gray-700 dark:text-gray-300 mb-1">New Monthly In-hand</p>
                                        <p id="hikeNewMonthly" class="text-2xl font-bold text-green-600 dark:text-green-400">₹0</p>
                                        <p id="hikeMonthlyIncrease" class="text-xs text-gray-600 dark:text-gray-400 mt-1">Increase: ₹0</p>
                                    </div>
                                    <div class="border-t border-green-200 dark:border-green-700 pt-4">
                                        <p class="text-sm text-gray-700 dark:text-gray-300 mb-1">New Annual In-hand</p>
                                        <p id="hikeNewAnnual" class="text-2xl font-bold text-green-600 dark:text-green-400">₹0</p>
                                        <p id="hikeAnnualIncrease" class="text-xs text-gray-600 dark:text-gray-400 mt-1">Increase: ₹0</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <button id="calculateHikeButton" class="w-full bg-gradient-to-r from-green-500 to-emerald-500 hover:from-green-600 hover:to-emerald-600 text-white font-bold py-3 px-6 rounded-lg transition-all mb-8">Calculate Hike</button>

                        <!-- Detailed Breakdown -->
                        <div id="hikeBreakdown" class="hidden bg-gray-50 dark:bg-gray-800 p-6 rounded-2xl border border-gray-200 dark:border-gray-700">
                            <h3 class="font-bold text-lg text-gray-900 dark:text-gray-100 mb-4">Salary Breakdown Comparison</h3>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <div class="text-center p-4 bg-white dark:bg-gray-700 rounded-lg">
                                    <p class="text-xs text-gray-600 dark:text-gray-400 mb-1">Current CTC</p>
                                    <p id="compareCurrentCtc" class="text-xl font-bold text-gray-900 dark:text-gray-100">₹0</p>
                                </div>
                                <div class="flex items-center justify-center text-2xl text-blue-600 dark:text-blue-400 font-bold">→</div>
                                <div class="text-center p-4 bg-white dark:bg-gray-700 rounded-lg">
                                    <p class="text-xs text-gray-600 dark:text-gray-400 mb-1">New CTC</p>
                                    <p id="compareNewCtc" class="text-xl font-bold text-green-600 dark:text-green-400">₹0</p>
                                </div>
                            </div>
                            <div class="mt-4 grid grid-cols-2 gap-4 text-sm">
                                <div class="p-3 bg-blue-100 dark:bg-blue-900/50 rounded-lg">
                                    <p class="text-gray-700 dark:text-gray-300">Current In-hand/Year</p>
                                    <p id="compareCurrentInhand" class="text-lg font-bold text-blue-600 dark:text-blue-400">₹0</p>
                                </div>
                                <div class="p-3 bg-green-100 dark:bg-green-900/50 rounded-lg">
                                    <p class="text-gray-700 dark:text-gray-300">New In-hand/Year</p>
                                    <p id="compareNewInhand" class="text-lg font-bold text-green-600 dark:text-green-400">₹0</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="additional" class="tab-panel hidden">
                <div class="max-w-6xl mx-auto">
                    <div class="bg-white/60 dark:bg-gray-900 backdrop-blur-lg rounded-3xl shadow-xl border border-gray-200/50 dark:border-gray-800 p-6 sm:p-8">
                        <h3 class="text-2xl font-bold mb-4 text-gray-900 dark:text-gray-100">Additional Calculators</h3>
                        <p class="text-gray-600 dark:text-gray-400 mb-6">Small utilities: PF, HRA exemption, Gratuity, LTA, Bonus and Cost-of-Living comparison.</p>

                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                            <!-- PF Calculator -->
                            <div class="p-5 rounded-2xl bg-amber-50 dark:bg-amber-950/20 border border-amber-200 dark:border-amber-700">
                                <h4 class="font-semibold mb-3">PF Calculator</h4>
                                <div class="space-y-2 text-sm">
                                    <div class="flex justify-between items-center">
                                        <label class="text-gray-700 dark:text-gray-300">Annual Basic (₹)</label>
                                        <input id="pf_basic" type="number" min="0" value="600000" class="w-36 bg-white dark:bg-gray-800 rounded-lg px-3 py-2 text-right">
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <label class="text-gray-700 dark:text-gray-300">Employee PF Rate (%)</label>
                                        <input id="pf_rate_emp" type="number" min="0" max="100" value="12" class="w-24 bg-white dark:bg-gray-800 rounded-lg px-3 py-2 text-right">
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <label class="text-gray-700 dark:text-gray-300">Employer PF Rate (%)</label>
                                        <input id="pf_rate_emp_er" type="number" min="0" max="100" value="12" class="w-24 bg-white dark:bg-gray-800 rounded-lg px-3 py-2 text-right">
                                    </div>
                                    <div class="pt-2 flex gap-2">
                                        <button id="calc_pf" class="flex-1 bg-teal-600 text-white py-2 rounded-lg">Calculate PF</button>
                                    </div>
                                    <div id="pf_result" class="mt-3 text-sm text-gray-700 dark:text-gray-200"></div>
                                </div>
                            </div>

                            <!-- HRA Exemption Calculator -->
                            <div class="p-5 rounded-2xl bg-sky-50 dark:bg-sky-950/20 border border-sky-200 dark:border-sky-700">
                                <h4 class="font-semibold mb-3">HRA Exemption Calculator</h4>
                                <div class="space-y-2 text-sm">
                                    <div class="flex justify-between items-center">
                                        <label class="text-gray-700 dark:text-gray-300">Basic Monthly (₹)</label>
                                        <input id="hra_basic_monthly" type="number" min="0" value="50000" class="w-36 bg-white dark:bg-gray-800 rounded-lg px-3 py-2 text-right">
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <label class="text-gray-700 dark:text-gray-300">HRA Received Monthly (₹)</label>
                                        <input id="hra_received_monthly" type="number" min="0" value="20000" class="w-36 bg-white dark:bg-gray-800 rounded-lg px-3 py-2 text-right">
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <label class="text-gray-700 dark:text-gray-300">Rent Paid Monthly (₹)</label>
                                        <input id="hra_rent_monthly" type="number" min="0" value="22000" class="w-36 bg-white dark:bg-gray-800 rounded-lg px-3 py-2 text-right">
                                    </div>
                                    <div class="flex items-center space-x-3">
                                        <label class="text-gray-700 dark:text-gray-300">City Type:</label>
                                        <select id="hra_city_type" class="bg-white dark:bg-gray-800 rounded-lg px-3 py-2 text-sm">
                                            <option value="metro">Metro (50%)</option>
                                            <option value="nonmetro">Non-Metro (40%)</option>
                                        </select>
                                    </div>
                                    <div class="pt-2 flex gap-2">
                                        <button id="calc_hra" class="flex-1 bg-blue-600 text-white py-2 rounded-lg">Calculate HRA Exemption</button>
                                    </div>
                                    <div id="hra_result" class="mt-3 text-sm text-gray-700 dark:text-gray-200"></div>
                                </div>
                            </div>

                            <!-- Gratuity Calculator -->
                            <div class="p-5 rounded-2xl bg-green-50 dark:bg-green-950/20 border border-green-200 dark:border-green-700">
                                <h4 class="font-semibold mb-3">Gratuity Calculator</h4>
                                <div class="space-y-2 text-sm">
                                    <div class="flex justify-between items-center">
                                        <label class="text-gray-700 dark:text-gray-300">Last Drawn Basic Monthly (₹)</label>
                                        <input id="grat_basic_monthly" type="number" min="0" value="50000" class="w-36 bg-white dark:bg-gray-800 rounded-lg px-3 py-2 text-right">
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <label class="text-gray-700 dark:text-gray-300">Years of Service</label>
                                        <input id="grat_years" type="number" min="0" value="5" class="w-24 bg-white dark:bg-gray-800 rounded-lg px-3 py-2 text-right">
                                    </div>
                                    <div class="pt-2 flex gap-2">
                                        <button id="calc_gratuity" class="flex-1 bg-emerald-600 text-white py-2 rounded-lg">Calculate Gratuity</button>
                                    </div>
                                    <div id="grat_result" class="mt-3 text-sm text-gray-700 dark:text-gray-200"></div>
                                </div>
                            </div>

                            <!-- LTA Calculator -->
                            <div class="p-5 rounded-2xl bg-amber-50 dark:bg-amber-950/20 border border-amber-200 dark:border-amber-700">
                                <h4 class="font-semibold mb-3">LTA Calculator</h4>
                                <div class="space-y-2 text-sm">
                                    <div class="flex justify-between items-center">
                                        <label class="text-gray-700 dark:text-gray-300">LTA Received (Annual ₹)</label>
                                        <input id="lta_received" type="number" min="0" value="40000" class="w-36 bg-white dark:bg-gray-800 rounded-lg px-3 py-2 text-right">
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <label class="text-gray-700 dark:text-gray-300">Travel Expenses Claimed (₹)</label>
                                        <input id="lta_expenses" type="number" min="0" value="35000" class="w-36 bg-white dark:bg-gray-800 rounded-lg px-3 py-2 text-right">
                                    </div>
                                    <div class="pt-2 flex gap-2">
                                        <button id="calc_lta" class="flex-1 bg-teal-600 text-white py-2 rounded-lg">Calculate LTA Exemption</button>
                                    </div>
                                    <div id="lta_result" class="mt-3 text-sm text-gray-700 dark:text-gray-200"></div>
                                </div>
                            </div>

                            <!-- Bonus Calculator -->
                            <div class="p-5 rounded-2xl bg-sky-50 dark:bg-sky-950/20 border border-sky-200 dark:border-sky-700">
                                <h4 class="font-semibold mb-3">Bonus Calculator</h4>
                                <div class="space-y-2 text-sm">
                                    <div class="flex justify-between items-center">
                                        <label class="text-gray-700 dark:text-gray-300">CTC or Basic (Annual ₹)</label>
                                        <input id="bonus_base" type="number" min="0" value="1000000" class="w-36 bg-white dark:bg-gray-800 rounded-lg px-3 py-2 text-right">
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <label class="text-gray-700 dark:text-gray-300">Bonus %</label>
                                        <input id="bonus_percent" type="number" min="0" max="100" value="10" class="w-24 bg-white dark:bg-gray-800 rounded-lg px-3 py-2 text-right">
                                    </div>
                                    <div class="pt-2 flex gap-2">
                                        <button id="calc_bonus" class="flex-1 bg-blue-600 text-white py-2 rounded-lg">Calculate Bonus</button>
                                    </div>
                                    <div id="bonus_result" class="mt-3 text-sm text-gray-700 dark:text-gray-200"></div>
                                </div>
                            </div>

                            <!-- Cost of Living Comparison -->
                            <div class="p-5 rounded-2xl bg-rose-50 dark:bg-rose-950/20 border border-rose-200 dark:border-rose-700 lg:col-span-2">
                                <h4 class="font-semibold mb-3">Cost-of-Living Comparison</h4>
                                <div class="grid grid-cols-1 md:grid-cols-3 gap-3 text-sm">
                                    <div>
                                        <label class="text-gray-700 dark:text-gray-300">City A</label>
                                        <select id="col_city_a" class="w-full bg-white dark:bg-gray-800 rounded-lg px-3 py-2">
                                            <option value="mumbai">Mumbai</option>
                                            <option value="bangalore">Bangalore</option>
                                            <option value="delhi">Delhi</option>
                                            <option value="pune">Pune</option>
                                            <option value="chennai">Chennai</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label class="text-gray-700 dark:text-gray-300">City B</label>
                                        <select id="col_city_b" class="w-full bg-white dark:bg-gray-800 rounded-lg px-3 py-2">
                                            <option value="pune">Pune</option>
                                            <option value="mumbai">Mumbai</option>
                                            <option value="bangalore">Bangalore</option>
                                            <option value="delhi">Delhi</option>
                                            <option value="chennai">Chennai</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label class="text-gray-700 dark:text-gray-300">Salary in City A (₹)</label>
                                        <input id="col_salary_a" type="number" min="0" value="1000000" class="w-full bg-white dark:bg-gray-800 rounded-lg px-3 py-2 text-right">
                                    </div>
                                </div>
                                <div class="pt-3">
                                    <button id="calc_col" class="bg-green-600 text-white py-2 px-4 rounded-lg">Compare Cost of Living</button>
                                </div>
                                <div id="col_result" class="mt-3 text-sm text-gray-700 dark:text-gray-200"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </main>

    <section id="about-section" class="max-w-5xl mx-auto px-4 py-20">
        <div class="mt-5">
            <h2 class="text-4xl font-extrabold mb-4 bg-gradient-to-r from-teal-700 via-teal-600 to-blue-600 bg-clip-text text-transparent dark:from-teal-200 dark:via-cyan-200 dark:to-blue-200 text-center">About the CTC Calculator</h2>
            <div class="bg-white/60 dark:bg-gray-900/40 backdrop-blur-xl border border-white/50 dark:border-gray-800 rounded-3xl p-10 shadow-[0_8px_25px_rgba(0,0,0,0.06)]">
                <p class="text-gray-700 dark:text-gray-300 leading-relaxed mt-4">This calculator helps you understand the breakdown of your Cost to Company (CTC) and estimate your in-hand salary. It accounts for common deductions like Employee Provident Fund (EPF), Professional Tax, and Income Tax under both the Old and New Tax Regimes.</p>
                <p class="text-gray-700 dark:text-gray-300 leading-relaxed mt-3">Please note that this is an estimation tool. The final salary and tax calculations may vary based on your company's specific policies and your complete financial profile. It's always a good idea to consult with a financial advisor for exact figures.</p>
            </div>
        </div>

        <div id="faq-section" class="mt-20">
            <h2 class="text-4xl font-extrabold mb-10 bg-gradient-to-r from-blue-700 via-teal-600 to-teal-700 bg-clip-text text-transparent dark:from-cyan-300 dark:via-teal-200 dark:to-blue-200 text-center">Frequently Asked Questions</h2>
            <div class="space-y-6">
                <div class="faq-card bg-white/60 dark:bg-gray-900/40 backdrop-blur-xl border border-white/50 dark:border-gray-800 rounded-2xl p-6 shadow-md cursor-pointer transition-all" onclick="toggleFAQ(this)">
                    <div class="flex justify-between items-center">
                        <h3 class="font-semibold text-lg text-gray-900 dark:text-gray-100">1. What is CTC (Cost to Company)?</h3>
                        <span class="faq-icon text-2xl text-teal-600 dark:text-teal-300 transition-all">+</span>
                    </div>
                    <p class="faq-answer text-gray-700 dark:text-gray-300 mt-3 hidden">CTC stands for 'Cost to Company'. It is the total amount that a company spends on an employee, directly or indirectly. It includes your gross salary, employer's contribution to EPF, gratuity (if applicable), and any other benefits.</p>
                </div>

                <div class="faq-card bg-white/60 dark:bg-gray-900/40 backdrop-blur-xl border border-white/50 dark:border-gray-800 rounded-2xl p-6 shadow-md cursor-pointer transition-all" onclick="toggleFAQ(this)">
                    <div class="flex justify-between items-center">
                        <h3 class="font-semibold text-lg text-gray-900 dark:text-gray-100">2. Old vs New Tax Regime?</h3>
                        <span class="faq-icon text-2xl text-teal-600 dark:text-teal-300 transition-all">+</span>
                    </div>
                    <p class="faq-answer text-gray-700 dark:text-gray-300 mt-3 hidden">Old: more deductions (HRA, LTA, 80C)<br>New: lower tax slabs but fewer exemptions.</p>
                </div>

                <div class="faq-card bg-white/60 dark:bg-gray-900/40 backdrop-blur-xl border border-white/50 dark:border-gray-800 rounded-2xl p-6 shadow-md cursor-pointer transition-all" onclick="toggleFAQ(this)">
                    <div class="flex justify-between items-center">
                        <h3 class="font-semibold text-lg text-gray-900 dark:text-gray-100">3. How is EPF calculated?</h3>
                        <span class="faq-icon text-2xl text-teal-600 dark:text-teal-300 transition-all">+</span>
                    </div>
                    <p class="faq-answer text-gray-700 dark:text-gray-300 mt-3 hidden">EPF = 12% of Basic Salary (employee) + 12% employer contribution.</p>
                </div>
            </div>
        </div>
    </section>

    <script>
        function toggleFAQ(card) {
            const answer = card.querySelector(".faq-answer");
            const icon = card.querySelector(".faq-icon");
            const isOpen = !answer.classList.contains("hidden");
            document.querySelectorAll(".faq-answer").forEach(a => a.classList.add("hidden"));
            document.querySelectorAll(".faq-icon").forEach(i => i.textContent = "+");
            if (!isOpen) {
                answer.classList.remove("hidden");
                icon.textContent = "−";
            }
        }
    </script>

    <footer class="relative py-16 px-4 sm:px-6 lg:px-8">
        <div class="absolute top-6 right-6 md:left-6 md:right-auto z-20">
            <div class="footer-logo-box">
                <img src="logo.png" alt="CTC Logo" class="footer-logo-img">
            </div>
        </div>
        <div class="max-w-5xl mx-auto px-6">
            <div class="grid grid-cols-2 md:grid-cols-4 gap-8">
                <div class="col-span-2 md:col-span-1">
                    <h4 class="font-semibold mb-4 text-lg">Calculators</h4>
                    <ul class="space-y-3">
                        <li><button class="footer-tab-btn text-sm transition-colors" data-tab-target="ctc-to-inhand">CTC → In-hand</button></li>
                        <li><button class="footer-tab-btn text-sm transition-colors" data-tab-target="inhand-to-ctc">In-hand → CTC</button></li>
                        <li><button class="footer-tab-btn text-sm transition-colors" data-tab-target="compare">Compare Offers</button></li>
                        <li><button class="footer-tab-btn text-sm transition-colors" data-tab-target="tax">Tax Calculator</button></li>
                        <li><button class="footer-tab-btn text-sm transition-colors" data-tab-target="hike">Hike Calculator</button></li>
                        <li><button class="footer-tab-btn text-sm transition-colors" data-tab-target="additional">Additional Calculator</button></li>
                    </ul>
                </div>
                <div class="col-span-2 md:col-span-2 grid grid-cols-2 gap-8">
                    <div>
                        <h4 class="font-semibold mb-4 text-lg">Resources</h4>
                        <ul class="space-y-3">
                            <li><a href="#" class="text-sm transition-colors">About Us</a></li>
                            <li><a href="#" class="text-sm transition-colors">Blog</a></li>
                            <li><a href="#" class="text-sm transition-colors">Contact</a></li>
                        </ul>
                    </div>
                    <div>
                        <h4 class="font-semibold mb-4 text-lg">Legal</h4>
                        <ul class="space-y-3">
                            <li><a href="#" class="text-sm transition-colors">Privacy Policy</a></li>
                            <li><a href="#" class="text-sm transition-colors">Terms of Service</a></li>
                        </ul>
                    </div>
                </div>
                <div class="col-span-2 md:col-span-1">
                    <h4 class="font-semibold mb-4 text-lg">Follow Us</h4>
                    <ul class="space-y-3">
                        <li><a href="#" class="text-sm transition-colors">Twitter</a></li>
                        <li><a href="#" class="text-sm transition-colors">LinkedIn</a></li>
                        <li><a href="#" class="text-sm transition-colors">GitHub</a></li>
                    </ul>
                </div>
            </div>
            <div class="mt-12 pt-8 text-center">
                <hr class="border-gray-200/80 dark:border-gray-700/80 mb-6" style="background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent); height: 1px; border: none;">
                <p class="text-sm">&copy; 2025 CTC Calculator. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <div id="taxDetailsModal" class="modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h2 class="text-xl font-semibold mb-4" id="taxModalTitle">Detailed Tax Calculation</h2>
            <div class="space-y-4">
                <div>
                    <h3 class="font-medium mb-2">Income Tax Slabs</h3>
                    <div id="taxSlabsBreakdown" class="text-sm space-y-2"></div>
                </div>
                <div>
                    <h3 class="font-medium mb-2">Additional Charges</h3>
                    <div id="additionalCharges" class="text-sm space-y-2">
                        <div class="flex justify-between"><span class="text-gray-600 dark:text-gray-400">Tax before Surcharge/Cess</span><span id="taxBeforeCharges">₹0</span></div>
                        <div class="flex justify-between"><span class="text-gray-600 dark:text-gray-400">Surcharge</span><span id="taxSurcharge">₹0</span></div>
                        <div class="flex justify-between"><span class="text-gray-600 dark:text-gray-400">Health & Education Cess (4%)</span><span id="educationCess">₹0</span></div>
                    </div>
                </div>
                <div class="pt-4 border-t border-gray-200 dark:border-gray-600">
                    <div class="flex justify-between font-semibold">
                        <span>Total Tax Liability</span>
                        <span id="totalTaxLiability">₹0</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Helper Functions
        function formatIndianCurrency(num) {
            num = Math.round(num);
            const units = Math.abs(num) >= 1e7 ? Math.abs(num) / 1e7 : Math.abs(num) >= 1e5 ? Math.abs(num) / 1e5 : Math.abs(num) >= 1e3 ? Math.abs(num) / 1e3 : Math.abs(num);
            if (Math.abs(num) >= 1e7) { return '₹ ' + units.toFixed(2) + ' Cr'; }
            else if (Math.abs(num) >= 1e5) { return '₹ ' + units.toFixed(2) + ' L'; }
            else if (Math.abs(num) >= 1e3) { return '₹ ' + units.toFixed(0) + ' K'; }
            return '₹ ' + num.toLocaleString('en-IN');
        }
        const f_simple = (val) => `₹${Math.round(val).toLocaleString('en-IN')}`;
        const neg_f_simple = (val) => `-₹${Math.round(val).toLocaleString('en-IN')}`;

        function getChartLabelColor() {
            if (document.documentElement.classList.contains('dark')) { return '#d1d5db'; }
            return '#374151';
        }

        function numberToWordsIndian(num) {
            num = Number(num) || 0;
            if (num === 0) return 'Zero rupees';
            const a = ['', 'one', 'two', 'three', 'four', 'five', 'six', 'seven', 'eight', 'nine', 'ten', 'eleven', 'twelve', 'thirteen', 'fourteen', 'fifteen', 'sixteen', 'seventeen', 'eighteen', 'nineteen'];
            const b = ['', '', 'twenty', 'thirty', 'forty', 'fifty', 'sixty', 'seventy', 'eighty', 'ninety'];
            function twoDigits(n) { if (n < 20) return a[n]; return b[Math.floor(n / 10)] + (n % 10 ? ' ' + a[n % 10] : ''); }
            function threeDigits(n) { let str = ''; if (n > 99) { str += a[Math.floor(n / 100)] + ' hundred'; if (n % 100) str += ' '; } if (n % 100) str += twoDigits(n % 100); return str; }
            const crore = Math.floor(num / 10000000); num = num % 10000000;
            const lakh = Math.floor(num / 100000); num = num % 100000;
            const thousand = Math.floor(num / 1000);
            const hund = Math.floor((num % 1000));
            const parts = [];
            if (crore) parts.push(twoDigits(crore) + ' crore');
            if (lakh) parts.push(twoDigits(lakh) + ' lakh');
            if (thousand) parts.push(twoDigits(thousand) + ' thousand');
            if (hund) parts.push(threeDigits(hund));
            const words = parts.join(' ').replace(/\s+/g, ' ').trim();
            return words.charAt(0).toUpperCase() + words.slice(1) + ' rupees';
        }

        // Main Logic
        document.addEventListener('DOMContentLoaded', () => {
            let calculationResults = {};
            let reverseCalculationResults = {};
            let salaryChart;
            let reverseSalaryChart;

            // DOM Elements
            const themeToggle = document.getElementById('theme-toggle');
            const lightIcon = document.getElementById('theme-icon-light');
            const darkIcon = document.getElementById('theme-icon-dark');
            const headerEl = document.querySelector('header');

            // Header Scroll Logic
            function handleHeaderOnScroll() {
                try {
                    if (window.scrollY > 20) { headerEl.classList.add('scrolled'); }
                    else { headerEl.classList.remove('scrolled'); }
                } catch (e) { console.warn('Header scroll handler error', e); }
            }
            window.addEventListener('scroll', handleHeaderOnScroll, { passive: true });
            handleHeaderOnScroll();

            // Tab 1 Inputs
            const ctcInputBox = document.getElementById('ctcInputBox');
            const ctcErrorMsg = document.getElementById('ctcErrorMsg');
            const ctcInWords = document.getElementById('ctcInWords');
            const basicInput = document.getElementById('basicInput');
            const insuranceAmount = document.getElementById('insuranceAmount');
            const otherDeductionsAmount = document.getElementById('otherDeductionsAmount');
            const npsPercent = document.getElementById('npsPercent');
            const includeProfTax = document.getElementById('includeProfTax');
            const taxRegimeInputs = document.querySelectorAll('input[name="taxRegime"]');
            const inputModeInputs = document.querySelectorAll('input[name="inputMode"]');
            
            // Display Spans/Inputs for fixed components
            const hraInputDisplay = document.getElementById('hraInputDisplay');
            const employerPFInputDisplay = document.getElementById('employerPFInputDisplay');
            const employeePFInputDisplay = document.getElementById('employeePFInputDisplay');
            const gratuityInputDisplay = document.getElementById('gratuityInputDisplay');
            const specialInputDisplay = document.getElementById('specialInputDisplay');
            
            // Tab 2 Inputs
            const monthlyInHandInputBox = document.getElementById('monthlyInHandInputBox');
            const monthlyInWords = document.getElementById('monthlyInWords');
            const reverseTaxRegimeInputs = document.querySelectorAll('input[name="taxRegime_reverse"]');
            const reverseIncludePF = document.getElementById('includePF_reverse');
            const reverseIncludeProfTax = document.getElementById('includeProfTax_reverse');
            const reverseCalcButton = document.getElementById('calculateReverse');

            // Menu & Tabs
            const tabButtons = document.querySelectorAll('.tab-btn');
            const tabPanels = document.querySelectorAll('.tab-panel');
            const mobileMenuToggle = document.getElementById('mobile-menu-toggle');
            const mobileMenu = document.getElementById('mobile-menu');

            // Modal
            const modal = document.getElementById('taxDetailsModal');
            const showTaxDetails = document.getElementById('showTaxDetails');
            const closeModal = document.querySelector('.close-modal');

            // Downloads
            const downloadPdfBtn = document.getElementById('downloadPdf');
            const downloadExcelBtn = document.getElementById('downloadExcel');
            const downloadPdfBtn_reverse = document.getElementById('downloadPdf_reverse');
            const downloadExcelBtn_reverse = document.getElementById('downloadExcel_reverse');

            // Tax Slabs
            const oldTaxSlabs = [
                { limit: 250000, rate: 0 }, { limit: 500000, rate: 0.05 },
                { limit: 1000000, rate: 0.20 }, { limit: Infinity, rate: 0.30 }
            ];
            const newTaxSlabs = [
                { limit: 300000, rate: 0 }, { limit: 600000, rate: 0.05 },
                { limit: 900000, rate: 0.10 }, { limit: 1200000, rate: 0.15 },
                { limit: 1500000, rate: 0.20 }, { limit: Infinity, rate: 0.30 }
            ];

            // Theme Toggle Logic
            function updateThemeIcon() {
                if (document.documentElement.classList.contains('dark')) {
                    lightIcon.classList.remove('hidden'); darkIcon.classList.add('hidden');
                } else {
                    lightIcon.classList.add('hidden'); darkIcon.classList.remove('hidden');
                }
            }
            themeToggle.addEventListener('click', () => {
                document.documentElement.classList.toggle('dark');
                localStorage.setItem('theme', document.documentElement.classList.contains('dark') ? 'dark' : 'light');
                updateThemeIcon();
                if (salaryChart) { salaryChart.options.plugins.legend.labels.color = getChartLabelColor(); salaryChart.update(); }
                if (reverseSalaryChart) { reverseSalaryChart.options.plugins.legend.labels.color = getChartLabelColor(); reverseSalaryChart.update(); }
            });

            // Tab Switching
            if (mobileMenuToggle && mobileMenu) {
                mobileMenuToggle.addEventListener('click', () => { mobileMenu.classList.toggle('hidden'); });
            }
            tabButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const targetTab = button.getAttribute('data-tab') || button.getAttribute('data-tab-target');
                    if (!targetTab) return;
                    document.querySelectorAll('.tab-btn, .footer-tab-btn').forEach(btn => btn.classList.remove('tab-active'));
                    tabPanels.forEach(panel => panel.classList.add('hidden'));
                    button.classList.add('tab-active');
                    const matchingHeaderTab = document.querySelector(`header .tab-btn[data-tab="${targetTab}"]`);
                    if (matchingHeaderTab) matchingHeaderTab.classList.add('tab-active');
                    const matchingFooterTab = document.querySelector(`.footer-tab-btn[data-tab-target="${targetTab}"]`);
                    if (matchingFooterTab) matchingFooterTab.classList.add('tab-active');
                    document.getElementById(targetTab).classList.remove('hidden');
                    if (mobileMenu && !mobileMenu.classList.contains('hidden')) mobileMenu.classList.add('hidden');
                });
            });

            function updateInputLabels() {
                const mode = document.querySelector('input[name="inputMode"]:checked').value;
                const labelSymbol = (mode === 'percentage') ? '(%)' : '(₹)';
                document.querySelector('.component-label').textContent = labelSymbol;
                document.querySelector('.component-label-nps').textContent = (mode === 'percentage') ? '(%)' : '(₹)';
                
                // If switching to amount, update the basic input value
                if (mode === 'amount') {
                    const ctc = parseFloat(ctcInputBox.value) || 0;
                    // Assuming 40% basic if moving to amount, based on user request.
                    basicInput.value = (ctc * 0.40).toFixed(0); 
                    // Set NPS input as amount if mode is amount
                    npsPercent.value = (ctc * (parseFloat(npsPercent.value) || 0) / 100).toFixed(0);
                } else {
                     // Set NPS input back to percent if mode is percent
                     // This assumes the user's input was the percentage if we switch back
                     npsPercent.value = (parseFloat(npsPercent.value) > 0) ? (parseFloat(npsPercent.value) / parseFloat(ctcInputBox.value) * 100).toFixed(0) : 0;
                     if (npsPercent.value > 14) npsPercent.value = 14;
                     
                     basicInput.value = 40; // Reset basic to default percentage
                }
                
                calculateSalary();
            }

            // CTC to In-Hand Logic (UPDATED)
            function calculateSalary() {
                const ctc = parseFloat(ctcInputBox ? ctcInputBox.value : 0) || 0;
                const inputMode = document.querySelector('input[name="inputMode"]:checked').value;
                const taxRegime = document.querySelector('input[name="taxRegime"]:checked').value;
                
                let basicValue = parseFloat(basicInput.value) || 0;
                
                // 1. Calculate Basic
                const basic = (inputMode === 'percentage') ? ctc * (basicValue / 100) : basicValue;
                
                // 2. Calculate fixed components based on Basic or fixed amounts
                const hra = basic * 0.40; // 40% of Basic
                const employerPF = basic * 0.12; // 12% of Basic
                const employeePF = basic * 0.12; // 12% of Basic
                const employerGratuity = basic * 0.0481; // 4.81% of Basic
                const insuranceEmployer = parseFloat(insuranceAmount.value) || 0; // Fixed amount
                const otherEmployer = parseFloat(otherDeductionsAmount.value) || 0; // Fixed amount
                
                // 3. Calculate NPS (limited to max 14% of Basic)
                let npsInput = parseFloat(npsPercent.value) || 0;
                let npsLimit = basic * 0.14;
                let npsDeduction = 0;
                
                if (inputMode === 'percentage') {
                    npsDeduction = Math.min(basic * (npsInput / 100), npsLimit);
                } else {
                    // If NPS is entered in amount mode, cap it at 14% of Basic.
                    npsDeduction = Math.min(npsInput, npsLimit);
                }
                
                // 4. Calculate Special Allowance (The Balancing Figure)
                const ctcCommitments = basic + hra + employerPF + employerGratuity + insuranceEmployer + otherEmployer;
                const special = Math.max(0, ctc - ctcCommitments);
                
                const components = { basic, hra, special, da: 0, lta: 0, bonus: 0 }; // Keep structure for consistency

                // 5. Deductions for In-hand calculation
                let profTax = includeProfTax.checked ? 2500 : 0;
                
                // Gross Salary is the sum of cash components received by the employee
                const grossSalary = components.basic + components.hra + components.special; // i.e., CTC minus Employer Contributions
                
                // 6. Calculate Taxable Income
                const standardDeduction = 50000;
                let taxableIncome = grossSalary;
                let taxDetails = {};

                if (taxRegime === 'old') {
                    // Old Regime Deductions
                    const hraExemption = Math.min(components.hra, (components.basic) * 0.50, grossSalary - (components.basic + components.hra)); // Simplified HRA exemption
                    const section80C = Math.min(employeePF, 150000); // Employee PF part of 80C
                    const nps80CCD1B = Math.min(npsDeduction, 50000); // NPS part of 80CCD(1B)

                    // Deductions applied to Taxable Income
                    taxableIncome -= (standardDeduction + hraExemption + section80C + nps80CCD1B);
                    
                    taxDetails = calculateTax(taxableIncome, oldTaxSlabs);
                    // Rebate u/s 87A: Max 12,500 if total taxable income <= 5,00,000
                    if (taxableIncome <= 500000) taxDetails.finalTax = Math.max(0, taxDetails.finalTax - 12500);
                } else {
                    // New Regime Deductions
                    taxableIncome -= (standardDeduction);
                    
                    taxDetails = calculateTax(taxableIncome, newTaxSlabs);
                    // Rebate u/s 87A (New Regime): Zero tax if total taxable income <= 7,00,000
                    if (taxableIncome <= 700000) taxDetails.finalTax = 0;
                }

                taxableIncome = Math.max(0, taxableIncome);
                const totalTax = taxDetails.finalTax;
                
                // Total employee deductions from Gross Salary
                const totalDeductions = employeePF + npsDeduction + profTax + totalTax;
                const netInHandYearly = grossSalary - totalDeductions;
                const netInHandMonthly = netInHandYearly / 12;

                calculationResults = { ctc, taxRegime, components, grossSalary, employerPF, employerGratuity, insuranceEmployer, otherEmployer, deductions: { employeePF, npsDeduction, profTax, totalTax, total: totalDeductions }, taxCalc: { taxableIncome, standardDeduction, ...taxDetails }, netInHandYearly, netInHandMonthly };
                updateUI(calculationResults);
            }

            function calculateTax(income, slabs) {
                let tax = 0;
                let remainingIncome = income;
                let previousLimit = 0;
                let slabBreakdown = [];
                
                for (let i = 0; i < slabs.length; i++) {
                    const slab = slabs[i];
                    if (remainingIncome <= 0) break;
                    
                    const upperLimit = slab.limit;
                    
                    let taxableInSlab;
                    if (upperLimit === Infinity) {
                        taxableInSlab = remainingIncome - previousLimit;
                    } else {
                        taxableInSlab = Math.min(remainingIncome, upperLimit) - previousLimit;
                    }
                    
                    if (taxableInSlab > 0) {
                        const taxInSlab = taxableInSlab * slab.rate;
                        tax += taxInSlab;
                        remainingIncome -= taxableInSlab;
                        
                        // To show correct breakdown in modal, use the slab limits
                        slabBreakdown.push({ range: `₹${previousLimit.toLocaleString('en-IN')} - ${slab.limit === Infinity ? 'Above' : f_simple(slab.limit)}`, rate: slab.rate * 100, tax: taxInSlab });
                    }
                    previousLimit = upperLimit;
                }
                
                const taxBeforeCharges = tax;
                let surcharge = 0;
                if (income > 5000000 && income <= 10000000) surcharge = tax * 0.10;
                else if (income > 10000000 && income <= 20000000) surcharge = tax * 0.15;
                else if (income > 20000000 && income <= 50000000) surcharge = tax * 0.25;
                else if (income > 50000000) surcharge = tax * 0.37;
                tax += surcharge;
                const cess = tax * 0.04;
                const finalTax = tax + cess;
                return { taxBeforeCharges, surcharge, cess, finalTax, slabBreakdown };
            }

            function updateUI(results) {
                const { components, taxRegime, grossSalary, employerPF, employerGratuity, insuranceEmployer, otherEmployer, deductions, taxCalc, netInHandYearly, netInHandMonthly, ctc } = results;
                
                document.getElementById('regimeTitle').textContent = `Salary Breakdown under ${taxRegime === 'old' ? 'Old' : 'New'} Tax Regime`;
                document.getElementById('monthlyInHand').textContent = formatIndianCurrency(netInHandMonthly);
                document.getElementById('netYearly').textContent = formatIndianCurrency(netInHandYearly);
                
                // Update component displays in the input panel
                hraInputDisplay.value = f_simple(components.hra);
                employerPFInputDisplay.value = f_simple(employerPF);
                employeePFInputDisplay.value = f_simple(deductions.employeePF);
                gratuityInputDisplay.value = f_simple(employerGratuity);
                specialInputDisplay.value = f_simple(components.special);

                // Earnings Breakdown
                document.getElementById('basicAmount').textContent = f_simple(components.basic);
                document.getElementById('hraAmount').textContent = f_simple(components.hra);
                document.getElementById('specialAmount').textContent = f_simple(components.special);
                document.getElementById('grossYearly').textContent = f_simple(grossSalary);
                
                // Tax Calculation
                document.getElementById('grossForTax').textContent = f_simple(grossSalary);
                document.getElementById('standardDeduction').textContent = neg_f_simple(taxCalc.standardDeduction);
                document.getElementById('taxableIncomeInitial').textContent = f_simple(taxCalc.taxableIncome);
                
                // Deductions (Annual)
                document.getElementById('epfEmployee').textContent = neg_f_simple(deductions.employeePF);
                document.getElementById('npsDeduction').textContent = neg_f_simple(deductions.npsDeduction || 0);
                document.getElementById('profTaxAmount').textContent = neg_f_simple(deductions.profTax);
                document.getElementById('incomeTax').textContent = neg_f_simple(deductions.totalTax);
                document.getElementById('deductionsYearly').textContent = neg_f_simple(deductions.total);
                
                // CTC Breakup
                document.getElementById('grossSalaryCtc').textContent = f_simple(grossSalary);
                document.getElementById('employerEpfCtc').textContent = f_simple(employerPF);
                document.getElementById('gratuityEmployerCtc').textContent = f_simple(employerGratuity || 0);
                document.getElementById('insuranceEmployerCtc').textContent = f_simple(insuranceEmployer || 0);
                document.getElementById('otherEmployerDeductionCtc').textContent = f_simple(otherEmployer || 0);
                document.getElementById('totalCtc').textContent = f_simple(ctc);
                
                updateChart(results);
            }

            function initializeChart() {
                const ctx = document.getElementById('salaryChart').getContext('2d');
                salaryChart = new Chart(ctx, {
                    type: 'pie',
                    data: { labels: ['Net In-Hand', 'Employee PF', 'Employee NPS', 'Prof. Tax', 'Income Tax'], datasets: [{ data: [1, 0, 0, 0, 0], backgroundColor: ['#0d9488', '#f59e0b', '#8b5cf6', '#eab308', '#ef4444'], borderWidth: 0 }] },
                    options: { responsive: true, plugins: { legend: { position: 'bottom', labels: { font: { size: 10 }, color: getChartLabelColor() } } } }
                });
            }

            function updateChart(results) {
                if (!salaryChart) initializeChart();
                salaryChart.data.datasets[0].data = [results.netInHandYearly, results.deductions.employeePF, results.deductions.npsDeduction, results.deductions.profTax, results.deductions.totalTax];
                salaryChart.update();
            }
            
            // NOTE: Reverse calculation logic uses different simplified component breakdown for estimation
            function initializeReverseChart() {
                const ctx = document.getElementById('reverseSalaryChart').getContext('2d');
                reverseSalaryChart = new Chart(ctx, {
                    type: 'pie',
                    data: { labels: ['Net In-Hand', 'Employee PF', 'Prof. Tax', 'Income Tax'], datasets: [{ data: [1, 0, 0, 0], backgroundColor: ['#0d9488', '#f59e0b', '#eab308', '#ef4444'], borderWidth: 0 }] },
                    options: { responsive: true, plugins: { legend: { position: 'bottom', labels: { font: { size: 10 }, color: getChartLabelColor() } } } }
                });
            }

            function updateReverseChart(results) {
                if (!reverseSalaryChart) initializeReverseChart();
                reverseSalaryChart.data.datasets[0].data = [results.netInHandYearly, results.deductions.employeePF, results.deductions.profTax, results.deductions.totalTax];
                reverseSalaryChart.update();
            }
            
            function handleReverseCalculation() {
                const targetInHandMonthly = parseFloat(monthlyInHandInputBox ? monthlyInHandInputBox.value : 0) || 0;
                if (targetInHandMonthly === 0) return;
                const params = {
                    taxRegime: document.querySelector('input[name="taxRegime_reverse"]:checked').value,
                    pf: reverseIncludePF.checked,
                    profTax: reverseIncludeProfTax.checked
                };
                let minCTC = targetInHandMonthly * 12;
                let maxCTC = targetInHandMonthly * 24;
                let finalResults = {};
                for (let i = 0; i < 30; i++) {
                    let trialCTC = (minCTC + maxCTC) / 2;
                    finalResults = calculateInHandFromCTC(trialCTC, params);
                    let currentInHand = finalResults.netInHandMonthly;
                    if (Math.abs(currentInHand - targetInHandMonthly) < 0.01) break;
                    if (currentInHand < targetInHandMonthly) minCTC = trialCTC; else maxCTC = trialCTC;
                }
                reverseCalculationResults = finalResults;
                updateReverseUI(finalResults, targetInHandMonthly);
            }

            // Simplified fixed logic for reverse calculation
            function calculateInHandFromCTC(trialCTC, params) {
                const { taxRegime, pf, profTax } = params;
                
                // Using the fixed component structure for estimation
                const basic = trialCTC * 0.40;
                const hra = basic * 0.40;
                const employerPF = pf ? basic * 0.12 : 0;
                const employerGratuity = basic * 0.0481; // Simplified: Assuming Gratuity applies
                const special = Math.max(0, trialCTC - (basic + hra + employerPF + employerGratuity));
                
                const components = { basic, hra, special };
                const grossSalary = components.basic + components.hra + components.special;
                
                const employeePF = pf ? basic * 0.12 : 0;
                const npsDeduction = 0; // Simplified: Assuming no NPS for reverse calculation
                
                let professionalTax = profTax ? 2500 : 0;
                const standardDeduction = 50000;
                
                let taxableIncome = grossSalary;
                let taxDetails = {};
                
                if (taxRegime === 'old') {
                    const hraExemption = Math.min(components.hra, (components.basic) * 0.50); 
                    const section80C = Math.min(employeePF, 150000); 

                    taxableIncome -= (standardDeduction + hraExemption + section80C);
                    taxableIncome = Math.max(0, taxableIncome);
                    
                    taxDetails = calculateTax(taxableIncome, oldTaxSlabs);
                    if (taxableIncome <= 500000) taxDetails.finalTax = Math.max(0, taxDetails.finalTax - 12500);
                } else {
                    taxableIncome -= standardDeduction;
                    taxableIncome = Math.max(0, taxableIncome);
                    
                    taxDetails = calculateTax(taxableIncome, newTaxSlabs);
                    if (taxableIncome <= 700000) taxDetails.finalTax = 0;
                }
                
                const totalTax = taxDetails.finalTax;
                const totalDeductions = employeePF + professionalTax + totalTax;
                const netInHandYearly = grossSalary - totalDeductions;
                const netInHandMonthly = netInHandYearly / 12;
                
                return { ctc: trialCTC, taxRegime, components, grossSalary, employerPF, deductions: { employeePF, profTax: professionalTax, totalTax, total: totalDeductions, npsDeduction: 0 }, netInHandYearly, netInHandMonthly };
            }

            function updateReverseUI(results, targetInHand) {
                const { ctc, taxRegime, components, grossSalary, employerPF, deductions, netInHandMonthly } = results;
                document.getElementById('reverseResultCard').classList.remove('hidden');
                document.getElementById('reverseRegimeTitle').textContent = `Required CTC Breakdown (${taxRegime} Regime)`;
                document.getElementById('calculatedCTC').textContent = formatIndianCurrency(ctc);
                document.getElementById('calculatedMonthlyInHand').textContent = formatIndianCurrency(netInHandMonthly);
                document.getElementById('reverse_basicAmount').textContent = f_simple(components.basic);
                document.getElementById('reverse_hraAmount').textContent = f_simple(components.hra);
                document.getElementById('reverse_specialAmount').textContent = f_simple(components.special);
                document.getElementById('reverse_grossYearly').textContent = f_simple(grossSalary);
                document.getElementById('reverse_epfEmployee').textContent = neg_f_simple(deductions.employeePF);
                document.getElementById('reverse_profTaxAmount').textContent = neg_f_simple(deductions.profTax);
                document.getElementById('reverse_incomeTax').textContent = neg_f_simple(deductions.totalTax);
                document.getElementById('reverse_deductionsYearly').textContent = neg_f_simple(deductions.total);
                document.getElementById('reverse_grossSalaryCtc').textContent = f_simple(grossSalary);
                document.getElementById('reverse_employerEpfCtc').textContent = f_simple(employerPF);
                document.getElementById('reverse_totalCtc').textContent = f_simple(ctc);
                updateReverseChart(results);
            }

            // Modal Logic
            showTaxDetails.addEventListener('click', () => { populateTaxModal(calculationResults); modal.style.display = 'block'; });
            closeModal.addEventListener('click', () => modal.style.display = 'none');
            window.addEventListener('click', (event) => { if (event.target === modal) modal.style.display = 'none'; });

            function populateTaxModal(results) {
                if (!results.taxCalc) return;
                const { taxRegime, taxCalc } = results;
                const { slabBreakdown, taxBeforeCharges, surcharge, cess, finalTax } = taxCalc;
                document.getElementById('taxModalTitle').textContent = `Detailed Tax Calculation (${taxRegime} Regime)`;
                const slabsContainer = document.getElementById('taxSlabsBreakdown');
                slabsContainer.innerHTML = '';
                slabBreakdown.forEach(slab => {
                    const row = document.createElement('div');
                    row.className = 'flex justify-between items-center';
                    row.innerHTML = `<span class="text-gray-600 dark:text-gray-400">${slab.range}</span><span class="text-sm bg-gray-100 dark:bg-gray-700 px-2 py-0.5 rounded-full">@ ${slab.rate}%</span><span class="font-medium text-gray-800 dark:text-gray-200">${f_simple(slab.tax)}</span>`;
                    slabsContainer.appendChild(row);
                });
                document.getElementById('taxBeforeCharges').textContent = f_simple(taxBeforeCharges);
                document.getElementById('taxSurcharge').textContent = f_simple(surcharge);
                document.getElementById('educationCess').textContent = f_simple(cess);
                document.getElementById('totalTaxLiability').textContent = f_simple(finalTax);
            }

            // Download Logic (UPDATED)
            downloadPdfBtn.addEventListener('click', () => {
                const { jsPDF } = window.jspdf;
                const doc = new jsPDF();
                const { components, grossSalary, employerPF, employerGratuity, insuranceEmployer, otherEmployer, deductions, netInHandYearly, netInHandMonthly, ctc, taxRegime } = calculationResults;
                if (!ctc) { alert('Please calculate CTC first.'); return; }
                doc.setFontSize(18); doc.text('Salary Breakdown (CTC to In-hand)', 105, 20, { align: 'center' });
                doc.setFontSize(12); doc.text(`Tax Regime: ${taxRegime === 'old' ? 'Old' : 'New'}`, 105, 30, { align: 'center' });
                let y = 45;
                doc.setFontSize(14); doc.text('Summary', 20, y); y += 10;
                doc.setFontSize(12); doc.text(`Total CTC:`, 20, y); doc.text(f_simple(ctc), 180, y, { align: 'right' }); y += 8;
                doc.text(`Net Annual Salary:`, 20, y); doc.text(f_simple(netInHandYearly), 180, y, { align: 'right' }); y += 8;
                doc.text(`Net Monthly Salary:`, 20, y); doc.text(f_simple(netInHandMonthly), 180, y, { align: 'right' }); y += 15;
                
                doc.setFontSize(14); doc.text('Earnings (Annual)', 20, y); y += 10;
                doc.setFontSize(12); doc.text('Basic Salary:', 20, y); doc.text(f_simple(components.basic), 180, y, { align: 'right' }); y += 8;
                doc.text('HRA:', 20, y); doc.text(f_simple(components.hra), 180, y, { align: 'right' }); y += 8;
                doc.text('Special Allowance:', 20, y); doc.text(f_simple(components.special), 180, y, { align: 'right' }); y += 8;
                doc.setFont(undefined, 'bold'); doc.text('Gross Salary:', 20, y); doc.text(f_simple(grossSalary), 180, y, { align: 'right' }); y += 15;
                
                doc.setFont(undefined, 'normal'); doc.setFontSize(14); doc.text('Employee Deductions (Annual)', 20, y); y += 10;
                doc.setFontSize(12); doc.text('Employee EPF:', 20, y); doc.text(f_simple(deductions.employeePF), 180, y, { align: 'right' }); y += 8;
                doc.text('Employee NPS:', 20, y); doc.text(f_simple(deductions.npsDeduction), 180, y, { align: 'right' }); y += 8;
                doc.text('Professional Tax:', 20, y); doc.text(f_simple(deductions.profTax), 180, y, { align: 'right' }); y += 8;
                doc.text('Income Tax:', 20, y); doc.text(f_simple(deductions.totalTax), 180, y, { align: 'right' }); y += 8;
                doc.setFont(undefined, 'bold'); doc.text('Total Employee Deductions:', 20, y); doc.text(f_simple(deductions.total), 180, y, { align: 'right' }); y += 15;
                
                doc.setFont(undefined, 'normal'); doc.setFontSize(14); doc.text('CTC Breakup (Employer Cost)', 20, y); y += 10;
                doc.setFontSize(12); doc.text('Gross Salary:', 20, y); doc.text(f_simple(grossSalary), 180, y, { align: 'right' }); y += 8;
                doc.text('Employer EPF:', 20, y); doc.text(f_simple(employerPF), 180, y, { align: 'right' }); y += 8;
                doc.text('Gratuity (Employer):', 20, y); doc.text(f_simple(employerGratuity), 180, y, { align: 'right' }); y += 8;
                doc.text('Insurance (Employer):', 20, y); doc.text(f_simple(insuranceEmployer), 180, y, { align: 'right' }); y += 8;
                doc.text('Other Deductions (Employer):', 20, y); doc.text(f_simple(otherEmployer), 180, y, { align: 'right' }); y += 8;
                doc.setFont(undefined, 'bold'); doc.text('Total CTC:', 20, y); doc.text(f_simple(ctc), 180, y, { align: 'right' });
                doc.save('salary-breakdown-ctc-to-inhand.pdf');
            });

            downloadExcelBtn.addEventListener('click', () => {
                const { components, grossSalary, employerPF, employerGratuity, insuranceEmployer, otherEmployer, deductions, netInHandYearly, netInHandMonthly, ctc, taxRegime } = calculationResults;
                if (!ctc) { alert('Please calculate CTC first.'); return; }
                const wb = XLSX.utils.book_new();
                const wsData = [
                    ['Salary Breakdown (CTC to In-hand)'], ['Tax Regime', taxRegime], 
                    [], ['Summary', 'Amount'], 
                    ['Total CTC', ctc], ['Net Annual Salary', netInHandYearly], ['Net Monthly Salary', netInHandMonthly], 
                    [], ['Earnings (Annual)', 'Amount'], 
                    ['Basic Salary', components.basic], 
                    ['HRA', components.hra], 
                    ['Special Allowance', components.special], 
                    ['Gross Salary', grossSalary], 
                    [], ['Employee Deductions (Annual)', 'Amount'], 
                    ['Employee EPF', deductions.employeePF], 
                    ['Employee NPS', deductions.npsDeduction], 
                    ['Professional Tax', deductions.profTax], 
                    ['Income Tax', deductions.totalTax], 
                    ['Total Employee Deductions', deductions.total], 
                    [], ['CTC Breakup (Employer Cost)', 'Amount'], 
                    ['Gross Salary', grossSalary], 
                    ['Employer EPF', employerPF], 
                    ['Gratuity (Employer)', employerGratuity], 
                    ['Insurance (Employer)', insuranceEmployer], 
                    ['Other Deductions (Employer)', otherEmployer], 
                    ['Total CTC', ctc]
                ];
                const ws = XLSX.utils.aoa_to_sheet(wsData);
                XLSX.utils.book_append_sheet(wb, ws, 'Salary Breakdown');
                XLSX.writeFile(wb, 'salary-breakdown-ctc-to-inhand.xlsx');
            });


            downloadPdfBtn_reverse.addEventListener('click', () => {
                const { jsPDF } = window.jspdf;
                const doc = new jsPDF();
                const { ctc, taxRegime, components, grossSalary, employerPF, deductions, netInHandYearly, netInHandMonthly } = reverseCalculationResults;
                if (!ctc) { alert('Please calculate a CTC first.'); return; }
                doc.setFontSize(18); doc.text('Salary Breakdown (In-hand to CTC)', 105, 20, { align: 'center' });
                doc.setFontSize(12); doc.text(`Tax Regime: ${taxRegime === 'old' ? 'Old' : 'New'}`, 105, 30, { align: 'center' });
                let y = 45;
                doc.setFontSize(14); doc.text('Summary', 20, y); y += 10;
                doc.setFontSize(12); doc.text(`Required Total CTC:`, 20, y); doc.text(f_simple(ctc), 180, y, { align: 'right' }); y += 8;
                doc.text(`Net Annual Salary:`, 20, y); doc.text(f_simple(netInHandYearly), 180, y, { align: 'right' }); y += 8;
                doc.text(`Net Monthly Salary:`, 20, y); doc.text(f_simple(netInHandMonthly), 180, y, { align: 'right' }); y += 15;
                doc.setFontSize(14); doc.text('Earnings (Annual)', 20, y); y += 10;
                doc.setFontSize(12); doc.text('Basic Salary:', 20, y); doc.text(f_simple(components.basic), 180, y, { align: 'right' }); y += 8;
                doc.text('HRA:', 20, y); doc.text(f_simple(components.hra), 180, y, { align: 'right' }); y += 8;
                doc.text('Special Allowance:', 20, y); doc.text(f_simple(components.special), 180, y, { align: 'right' }); y += 8;
                doc.setFont(undefined, 'bold'); doc.text('Gross Salary:', 20, y); doc.text(f_simple(grossSalary), 180, y, { align: 'right' }); y += 15;
                doc.setFont(undefined, 'normal'); doc.setFontSize(14); doc.text('Deductions (Annual)', 20, y); y += 10;
                doc.setFontSize(12); doc.text('Employee EPF:', 20, y); doc.text(f_simple(deductions.employeePF), 180, y, { align: 'right' }); y += 8;
                doc.text('Professional Tax:', 20, y); doc.text(f_simple(deductions.profTax), 180, y, { align: 'right' }); y += 8;
                doc.text('Income Tax:', 20, y); doc.text(f_simple(deductions.totalTax), 180, y, { align: 'right' }); y += 8;
                doc.setFont(undefined, 'bold'); doc.text('Total Deductions:', 20, y); doc.text(f_simple(deductions.total), 180, y, { align: 'right' }); y += 15;
                doc.setFont(undefined, 'normal'); doc.setFontSize(14); doc.text('CTC Breakup', 20, y); y += 10;
                doc.setFontSize(12); doc.text('Gross Salary:', 20, y); doc.text(f_simple(grossSalary), 180, y, { align: 'right' }); y += 8;
                doc.text('Employer EPF:', 20, y); doc.text(f_simple(employerPF), 180, y, { align: 'right' }); y += 8;
                doc.setFont(undefined, 'bold'); doc.text('Total CTC:', 20, y); doc.text(f_simple(ctc), 180, y, { align: 'right' });
                doc.save('salary-breakdown-inhand-to-ctc.pdf');
            });

            downloadExcelBtn_reverse.addEventListener('click', () => {
                const { ctc, taxRegime, components, grossSalary, employerPF, deductions, netInHandYearly, netInHandMonthly } = reverseCalculationResults;
                if (!ctc) { alert('Please calculate a CTC first.'); return; }
                const wb = XLSX.utils.book_new();
                const wsData = [
                    ['Salary Breakdown (In-hand to CTC)'], ['Tax Regime', taxRegime], 
                    [], ['Summary', 'Amount'], 
                    ['Required Total CTC', ctc], ['Net Annual Salary', netInHandYearly], ['Net Monthly Salary', netInHandMonthly], 
                    [], ['Earnings (Annual)', 'Amount'], 
                    ['Basic Salary', components.basic], 
                    ['HRA', components.hra], 
                    ['Special Allowance', components.special], 
                    ['Gross Salary', grossSalary], 
                    [], ['Deductions (Annual)', 'Amount'], 
                    ['Employee EPF', deductions.employeePF], 
                    ['Professional Tax', deductions.profTax], 
                    ['Income Tax', deductions.totalTax], 
                    ['Total Deductions', deductions.total], 
                    [], ['CTC Breakup', 'Amount'], 
                    ['Gross Salary', grossSalary], 
                    ['Employer EPF', employerPF], 
                    ['Total CTC', ctc]
                ];
                const ws = XLSX.utils.aoa_to_sheet(wsData);
                XLSX.utils.book_append_sheet(wb, ws, 'Salary Breakdown');
                XLSX.writeFile(wb, 'salary-breakdown-inhand-to-ctc.xlsx');
            });


            // Initialization
            updateThemeIcon();
            initializeChart();
            try { if (ctcInWords) ctcInWords.textContent = numberToWordsIndian(ctcInputBox ? ctcInputBox.value : 0); } catch (e) { }
            try { if (monthlyInWords) monthlyInWords.textContent = numberToWordsIndian(monthlyInHandInputBox ? monthlyInHandInputBox.value : 0); } catch (e) { }
            
            // Set default NPS to amount if mode is amount to avoid % calculation on first load
            document.querySelector('input[name="inputMode"][value="percentage"]').addEventListener('change', updateInputLabels);
            document.querySelector('input[name="inputMode"][value="amount"]').addEventListener('change', updateInputLabels);
            
            updateInputLabels(); // Initial calculation and label update
            handleReverseCalculation();

            // Inputs Listeners (UPDATED)
            [basicInput, insuranceAmount, otherDeductionsAmount, npsPercent].forEach(input => {
                input.addEventListener('input', (e) => {
                    let val = e.target.value;
                    // Remove leading zeros
                    if (val.length > 1 && val.startsWith('0')) {
                        val = val.replace(/^0+/, '');
                        e.target.value = val;
                    }
                    // Ensure no negative numbers
                    if (parseFloat(val) < 0) {
                        e.target.value = '0';
                    }
                    calculateSalary();
                });
                // Prevent decimal, minus, and scientific notation keys
                input.addEventListener('keydown', (e) => {
                    if (e.key === '.' || e.key === '-' || e.key === 'e' || e.key === 'E' || e.key === '+') {
                        e.preventDefault();
                    }
                });
            });
            taxRegimeInputs.forEach(input => input.addEventListener('change', calculateSalary));
            includeProfTax.addEventListener('change', calculateSalary);

            if (ctcInputBox) {
                ctcInputBox.addEventListener('input', (e) => {
                    let val = e.target.value;
                    if (val.length > 1 && val.startsWith('0')) {
                        val = val.replace(/^0+/, '');
                        e.target.value = val;
                    }
                    if (parseFloat(val) < 0) {
                        ctcErrorMsg.classList.remove('hidden');
                        return;
                    } else {
                        ctcErrorMsg.classList.add('hidden');
                    }
                    try { if (ctcInWords) ctcInWords.textContent = numberToWordsIndian(val); } catch (e) { }
                    calculateSalary();
                });
                
                ctcInputBox.addEventListener('keydown', (e) => {
                    if (e.key === '.' || e.key === '-' || e.key === 'e') {
                        e.preventDefault();
                    }
                });
            }

            [reverseIncludePF, reverseIncludeProfTax].forEach(input => input.addEventListener('input', handleReverseCalculation));
            reverseTaxRegimeInputs.forEach(input => input.addEventListener('change', handleReverseCalculation));
            reverseCalcButton.addEventListener('click', handleReverseCalculation);
            if (monthlyInHandInputBox) {
                monthlyInHandInputBox.addEventListener('input', (e) => { try { if (monthlyInWords) monthlyInWords.textContent = numberToWordsIndian(e.target.value); } catch (e) { } handleReverseCalculation(); });
                monthlyInHandInputBox.addEventListener('change', (e) => { let value = parseInt(e.target.value); const min = parseInt(e.target.min || 0); const max = parseInt(e.target.max || Number.MAX_SAFE_INTEGER); if (isNaN(value) || value < min) value = min; if (value > max) value = max; e.target.value = value; try { if (monthlyInWords) monthlyInWords.textContent = numberToWordsIndian(e.target.value); } catch (e) { } handleReverseCalculation(); });
            }
            const footerTabButtons = document.querySelectorAll('.footer-tab-btn');
            footerTabButtons.forEach(button => {
                button.addEventListener('click', (e) => {
                    const targetTab = e.target.getAttribute('data-tab-target');
                    const headerButton = document.querySelector(`header .tab-btn[data-tab="${targetTab}"]`);
                    if (headerButton) { headerButton.click(); window.scrollTo({ top: 0, behavior: 'smooth' }); }
                });
            });

            // ============ COMPARE OFFERS CALCULATOR ============
            const compareButton = document.getElementById('compareButton');
            compareButton.addEventListener('click', () => {
                const ctc1 = parseFloat(document.getElementById('offerCtc1').value) || 0;
                const ctc2 = parseFloat(document.getElementById('offerCtc2').value) || 0;
                const regime1 = document.getElementById('offerRegime1').value;
                const regime2 = document.getElementById('offerRegime2').value;

                if (!ctc1 || !ctc2) { alert('Please enter both CTCs'); return; }

                const offer1 = calculateOfferBreakdown(ctc1, regime1);
                const offer2 = calculateOfferBreakdown(ctc2, regime2);

                document.getElementById('compare1Gross').textContent = f_simple(offer1.grossSalary);
                document.getElementById('compare1Deductions').textContent = f_simple(offer1.totalDeductions);
                document.getElementById('compare1InHand').textContent = f_simple(offer1.netInHandYearly);
                document.getElementById('compare1Monthly').textContent = f_simple(offer1.netInHandMonthly);

                document.getElementById('compare2Gross').textContent = f_simple(offer2.grossSalary);
                document.getElementById('compare2Deductions').textContent = f_simple(offer2.totalDeductions);
                document.getElementById('compare2InHand').textContent = f_simple(offer2.netInHandYearly);
                document.getElementById('compare2Monthly').textContent = f_simple(offer2.netInHandMonthly);

                const ctcDiff = ctc2 - ctc1;
                const inHandDiff = offer2.netInHandYearly - offer1.netInHandYearly;
                const monthlyDiff = offer2.netInHandMonthly - offer1.netInHandMonthly;
                const betterOffer = inHandDiff > 0 ? 'Offer 2 is Better' : inHandDiff < 0 ? 'Offer 1 is Better' : 'Equal';

                document.getElementById('compareCTCDiff').textContent = (ctcDiff >= 0 ? '+' : '') + f_simple(ctcDiff);
                document.getElementById('compareInHandDiff').textContent = (inHandDiff >= 0 ? '+' : '') + f_simple(inHandDiff);
                document.getElementById('compareMonthlyDiff').textContent = (monthlyDiff >= 0 ? '+' : '') + f_simple(monthlyDiff);
                document.getElementById('compareBetterOffer').textContent = betterOffer;

                document.getElementById('compareResults').classList.remove('hidden');
            });

            function calculateOfferBreakdown(ctc, regime) {
                const basic = ctc * 0.40;
                const hra = basic * 0.40;
                const employerPF = basic * 0.12;
                const gratuity = basic * 0.0481;
                const special = Math.max(0, ctc - (basic + hra + employerPF + gratuity));
                
                const grossSalary = basic + hra + special;
                const employeePF = basic * 0.12;
                const profTax = 2500;
                
                const standardDeduction = 50000;
                let taxableIncome = grossSalary - standardDeduction;
                let taxDetails = {};

                if (regime === 'old') {
                    const hraExemption = Math.min(hra, basic * 0.50, grossSalary - basic - hra);
                    taxableIncome -= hraExemption;
                    taxDetails = calculateTax(taxableIncome, oldTaxSlabs);
                    if (taxableIncome <= 500000) taxDetails.finalTax = Math.max(0, taxDetails.finalTax - 12500);
                } else {
                    taxDetails = calculateTax(taxableIncome, newTaxSlabs);
                    if (taxableIncome <= 700000) taxDetails.finalTax = 0;
                }

                const totalDeductions = employeePF + profTax + taxDetails.finalTax;
                const netInHandYearly = grossSalary - totalDeductions;
                const netInHandMonthly = netInHandYearly / 12;

                return { grossSalary, employerPF, totalDeductions, netInHandYearly, netInHandMonthly };
            }

            // ============ TAX CALCULATOR (OLD vs NEW) ============
            const calculateTaxButton = document.getElementById('calculateTaxButton');
            calculateTaxButton.addEventListener('click', () => {
                const grossIncome = parseFloat(document.getElementById('taxGrossIncome').value) || 0;
                if (!grossIncome) { alert('Please enter gross income'); return; }

                const empPF = parseFloat(document.getElementById('taxEmpPF').value) || 0;
                const nps = parseFloat(document.getElementById('taxNPS').value) || 0;

                // OLD REGIME
                const hraExemption = grossIncome * 0.10;
                const section80C = Math.min(empPF, 150000);
                const nps80CCD = Math.min(nps, 50000);
                const oldTaxableIncome = Math.max(0, grossIncome - 50000 - hraExemption - section80C - nps80CCD);
                const oldTaxCalc = calculateTax(oldTaxableIncome, oldTaxSlabs);
                let oldFinalTax = oldTaxCalc.finalTax;
                if (oldTaxableIncome <= 500000) oldFinalTax = Math.max(0, oldFinalTax - 12500);

                // NEW REGIME
                const newTaxableIncome = Math.max(0, grossIncome - 50000);
                const newTaxCalc = calculateTax(newTaxableIncome, newTaxSlabs);
                let newFinalTax = newTaxCalc.finalTax;
                if (newTaxableIncome <= 700000) newFinalTax = 0;

                // Display OLD Regime
                document.getElementById('taxOldGross').textContent = f_simple(grossIncome);
                document.getElementById('taxOld80C').textContent = f_simple(section80C);
                document.getElementById('taxOld80CCD').textContent = f_simple(nps80CCD);
                document.getElementById('taxOldTaxable').textContent = f_simple(oldTaxableIncome);
                document.getElementById('taxOldTax').textContent = f_simple(oldTaxCalc.taxBeforeCharges);
                document.getElementById('taxOldSurcharge').textContent = f_simple((oldTaxCalc.surcharge || 0) + (oldTaxCalc.cess || 0));
                document.getElementById('taxOldTotal').textContent = f_simple(oldFinalTax);

                // Display NEW Regime
                document.getElementById('taxNewGross').textContent = f_simple(grossIncome);
                document.getElementById('taxNewTaxable').textContent = f_simple(newTaxableIncome);
                document.getElementById('taxNewTax').textContent = f_simple(newTaxCalc.taxBeforeCharges);
                document.getElementById('taxNewSurcharge').textContent = f_simple((newTaxCalc.surcharge || 0) + (newTaxCalc.cess || 0));
                document.getElementById('taxNewTotal').textContent = f_simple(newFinalTax);

                const saving = oldFinalTax - newFinalTax;
                const betterRegime = saving > 0 ? 'New Regime (Save ₹' + Math.round(saving).toLocaleString('en-IN') + ')' : 'Old Regime (Save ₹' + Math.round(-saving).toLocaleString('en-IN') + ')';

                document.getElementById('taxSaving').textContent = f_simple(Math.abs(saving));
                document.getElementById('taxBetterRegime').textContent = betterRegime;
                document.getElementById('taxResults').classList.remove('hidden');
            });

            // ============ HIKE CALCULATOR ============
            const calculateHikeButton = document.getElementById('calculateHikeButton');
            calculateHikeButton.addEventListener('click', () => {
                const currentCtc = parseFloat(document.getElementById('hikeCurrentCtc').value) || 0;
                const currentMonthly = parseFloat(document.getElementById('hikeCurrentMonthly').value) || 0;
                const hikePercent = parseFloat(document.getElementById('hikePercentage').value) || 0;
                const regime = document.getElementById('hikeRegime').value;

                if (!currentCtc || !currentMonthly) { alert('Please enter current salary details'); return; }

                const newCtc = currentCtc * (1 + hikePercent / 100);
                const newOffer = calculateOfferBreakdown(newCtc, regime);

                const currentAnnualInhand = currentMonthly * 12;

                // Display Results
                document.getElementById('hikeNewCtc').textContent = f_simple(newCtc);
                document.getElementById('hikeCtcIncrease').textContent = 'Increase: ' + f_simple(newCtc - currentCtc) + ' (' + hikePercent + '%)';

                document.getElementById('hikeNewMonthly').textContent = f_simple(newOffer.netInHandMonthly);
                document.getElementById('hikeMonthlyIncrease').textContent = 'Increase: ' + f_simple(newOffer.netInHandMonthly - currentMonthly);

                document.getElementById('hikeNewAnnual').textContent = f_simple(newOffer.netInHandYearly);
                document.getElementById('hikeAnnualIncrease').textContent = 'Increase: ' + f_simple(newOffer.netInHandYearly - currentAnnualInhand);

                // Display Breakdown
                document.getElementById('compareCurrentCtc').textContent = f_simple(currentCtc);
                document.getElementById('compareNewCtc').textContent = f_simple(newCtc);
                document.getElementById('compareCurrentInhand').textContent = f_simple(currentAnnualInhand);
                document.getElementById('compareNewInhand').textContent = f_simple(newOffer.netInHandYearly);

                document.getElementById('hikeBreakdown').classList.remove('hidden');
            });

            // --- wire number-to-words displays for new inputs ---
            const wireWords = (inputId, wordsId) => {
                const inp = document.getElementById(inputId);
                const out = document.getElementById(wordsId);
                if (!inp || !out) return;
                const update = (v) => {
                    try { out.textContent = numberToWordsIndian(v || inp.value || 0); } catch (e) { out.textContent = 'Zero rupees'; }
                };
                // initialize
                update();
                inp.addEventListener('input', (e) => {
                    let val = e.target.value;
                    if (val.length > 1 && val.startsWith('0')) { val = val.replace(/^0+/, ''); e.target.value = val; }
                    update(val);
                });
                inp.addEventListener('keydown', (e) => { if (['.', '-', 'e', 'E', '+'].includes(e.key)) e.preventDefault(); });
            };

            wireWords('offerCtc1', 'offerCtc1Words');
            wireWords('offerCtc2', 'offerCtc2Words');
            wireWords('taxGrossIncome', 'taxGrossWords');
            wireWords('hikeCurrentCtc', 'hikeCurrentCtcWords');
            wireWords('hikeCurrentMonthly', 'hikeCurrentMonthlyWords');
        });
    </script>

    <script>
        // Global numeric input enforcement
        // Prevent negatives, decimals, scientific notation and leading zeros across all numeric inputs
        (function () {
            const forbiddenKeys = ['.', '-', 'e', 'E', '+'];
            const inputs = Array.from(document.querySelectorAll('input[type="number"]'));

            inputs.forEach((inp) => {
                // Keydown: block forbidden characters
                inp.addEventListener('keydown', (e) => {
                    if (forbiddenKeys.includes(e.key)) e.preventDefault();
                });

                // Paste: sanitize pasted content
                inp.addEventListener('paste', (e) => {
                    e.preventDefault();
                    const text = (e.clipboardData || window.clipboardData).getData('text') || '';
                    let sanitized = text.replace(/\D+/g, '');
                    if (sanitized.length > 1 && sanitized.startsWith('0')) sanitized = sanitized.replace(/^0+/, '');
                    inp.value = sanitized;
                    // Dispatch input so other listeners (words, calculations) update
                    const ev = new Event('input', { bubbles: true });
                    inp.dataset._sanitizing = '1';
                    inp.dispatchEvent(ev);
                });

                // Input: sanitize live typing
                inp.addEventListener('input', (e) => {
                    // If this input event is re-dispatched by our code, skip re-processing once
                    if (e.target.dataset._sanitizing === '1') { e.target.dataset._sanitizing = '0'; return; }

                    let v = e.target.value || '';
                    // Remove any non-digit characters (disallow decimals and signs)
                    v = v.replace(/\D+/g, '');
                    // Strip leading zeros when length > 1
                    if (v.length > 1 && v.startsWith('0')) v = v.replace(/^0+/, '');

                    // Apply sanitized value back
                    if (e.target.value !== v) e.target.value = v;

                    // Clamp to min/max if attributes provided
                    const minAttr = e.target.getAttribute('min');
                    const maxAttr = e.target.getAttribute('max');
                    if (v !== '') {
                        let num = parseInt(v, 10);
                        if (minAttr !== null && minAttr !== '' && !isNaN(minAttr) && num < parseInt(minAttr, 10)) {
                            num = parseInt(minAttr, 10);
                            e.target.value = String(num);
                        }
                        if (maxAttr !== null && maxAttr !== '' && !isNaN(maxAttr) && num > parseInt(maxAttr, 10)) {
                            e.target.value = String(parseInt(maxAttr, 10));
                        }
                    }

                    // Re-dispatch an 'input' event so other listeners (number-to-words, calc) run.
                    // We mark dataset._sanitizing to avoid re-processing our own dispatched event.
                    e.target.dataset._sanitizing = '1';
                    const ev = new Event('input', { bubbles: true });
                    e.target.dispatchEvent(ev);
                });

                // Change: ensure final value is integer and fallback to min if empty
                inp.addEventListener('change', (e) => {
                    let v = e.target.value || '';
                    v = v.replace(/\D+/g, '');
                    if (v.length > 1 && v.startsWith('0')) v = v.replace(/^0+/, '');
                    if (v === '') {
                        const minAttr = e.target.getAttribute('min');
                        e.target.value = (minAttr !== null && minAttr !== '') ? minAttr : '';
                        return;
                    }
                    e.target.value = v;
                });
            });
        })();
    </script>

    <script>
        // Additional calculators logic (PF, HRA, Gratuity, LTA, Bonus, COL)
        document.addEventListener('DOMContentLoaded', () => {
            // PF
            const pfBasic = document.getElementById('pf_basic');
            const pfRateEmp = document.getElementById('pf_rate_emp');
            const pfRateEr = document.getElementById('pf_rate_emp_er');
            const pfBtn = document.getElementById('calc_pf');
            const pfRes = document.getElementById('pf_result');
            pfBtn.addEventListener('click', () => {
                const basic = parseFloat(pfBasic.value) || 0;
                const empRate = (parseFloat(pfRateEmp.value) || 0) / 100;
                const erRate = (parseFloat(pfRateEr.value) || 0) / 100;
                const empYear = basic * empRate;
                const erYear = basic * erRate;
                const empMonth = empYear / 12;
                const erMonth = erYear / 12;
                pfRes.innerHTML = `<div>Employee PF: <strong>${f_simple(empYear)}</strong> / month <strong>${f_simple(empMonth)}</strong></div>` +
                    `<div>Employer PF: <strong>${f_simple(erYear)}</strong> / month <strong>${f_simple(erMonth)}</strong></div>`;
            });

            // HRA Exemption
            const hraBasicMonthly = document.getElementById('hra_basic_monthly');
            const hraReceivedMonthly = document.getElementById('hra_received_monthly');
            const hraRentMonthly = document.getElementById('hra_rent_monthly');
            const hraCityType = document.getElementById('hra_city_type');
            const hraBtn = document.getElementById('calc_hra');
            const hraRes = document.getElementById('hra_result');
            hraBtn.addEventListener('click', () => {
                const b = parseFloat(hraBasicMonthly.value) || 0;
                const hraRecv = parseFloat(hraReceivedMonthly.value) || 0;
                const rent = parseFloat(hraRentMonthly.value) || 0;
                const city = hraCityType.value;
                const actualHRA = hraRecv * 12;
                const rentMinus10Pct = Math.max(0, (rent - 0.10 * b)) * 12;
                const perc = city === 'metro' ? 0.50 : 0.40;
                const pctOfBasic = b * perc * 12;
                const exemption = Math.max(0, Math.min(actualHRA, rentMinus10Pct, pctOfBasic));
                hraRes.innerHTML = `<div>Actual HRA received (annual): <strong>${f_simple(actualHRA)}</strong></div>` +
                    `<div>Rent - 10% of Basic (annual): <strong>${f_simple(rentMinus10Pct)}</strong></div>` +
                    `<div>${Math.round(perc * 100)}% of Basic (annual): <strong>${f_simple(pctOfBasic)}</strong></div>` +
                    `<div class="mt-2 font-semibold">HRA Exemption (annual): <strong>${f_simple(exemption)}</strong></div>`;
            });

            // Gratuity
            const gratBasicMonthly = document.getElementById('grat_basic_monthly');
            const gratYears = document.getElementById('grat_years');
            const gratBtn = document.getElementById('calc_gratuity');
            const gratRes = document.getElementById('grat_result');
            gratBtn.addEventListener('click', () => {
                const basicMonthly = parseFloat(gratBasicMonthly.value) || 0;
                const years = parseFloat(gratYears.value) || 0;
                // Gratuity (Payment of Gratuity Act): (Basic+DA) * 15/26 * years
                const gratuity = (basicMonthly) * (15 / 26) * years;
                gratRes.innerHTML = `<div>Estimated Gratuity: <strong>${f_simple(gratuity)}</strong></div>`;
            });

            // LTA
            const ltaReceived = document.getElementById('lta_received');
            const ltaExpenses = document.getElementById('lta_expenses');
            const ltaBtn = document.getElementById('calc_lta');
            const ltaRes = document.getElementById('lta_result');
            ltaBtn.addEventListener('click', () => {
                const rec = parseFloat(ltaReceived.value) || 0;
                const exp = parseFloat(ltaExpenses.value) || 0;
                const exempt = Math.min(rec, exp);
                ltaRes.innerHTML = `<div>LTA Received: <strong>${f_simple(rec)}</strong></div>` +
                    `<div>Expenses Claimed: <strong>${f_simple(exp)}</strong></div>` +
                    `<div class="mt-2 font-semibold">LTA Exempt: <strong>${f_simple(exempt)}</strong></div>`;
            });

            // Bonus
            const bonusBase = document.getElementById('bonus_base');
            const bonusPercent = document.getElementById('bonus_percent');
            const bonusBtn = document.getElementById('calc_bonus');
            const bonusRes = document.getElementById('bonus_result');
            bonusBtn.addEventListener('click', () => {
                const base = parseFloat(bonusBase.value) || 0;
                const pct = (parseFloat(bonusPercent.value) || 0) / 100;
                const bonus = base * pct;
                bonusRes.innerHTML = `<div>Bonus Amount: <strong>${f_simple(bonus)}</strong></div>`;
            });

            // Cost of Living Comparison
            const colMap = { mumbai: 1.00, bangalore: 0.95, delhi: 0.90, pune: 0.85, chennai: 0.82 };
            const colCityA = document.getElementById('col_city_a');
            const colCityB = document.getElementById('col_city_b');
            const colSalaryA = document.getElementById('col_salary_a');
            const colBtn = document.getElementById('calc_col');
            const colRes = document.getElementById('col_result');
            colBtn.addEventListener('click', () => {
                const a = colCityA.value;
                const b = colCityB.value;
                const salaryA = parseFloat(colSalaryA.value) || 0;
                const idxA = colMap[a] || 1;
                const idxB = colMap[b] || 1;
                // Required salary in B to match purchasing power in A: salaryB = salaryA * (idxB / idxA)
                const salaryB = salaryA * (idxB / idxA);
                colRes.innerHTML = `<div>If you earn <strong>${f_simple(salaryA)}</strong> in ${a.charAt(0).toUpperCase() + a.slice(1)}, you need approximately <strong>${f_simple(salaryB)}</strong> in ${b.charAt(0).toUpperCase() + b.slice(1)} to match cost-of-living.</div>`;
            });
        });
    </script>

</body>
</html>